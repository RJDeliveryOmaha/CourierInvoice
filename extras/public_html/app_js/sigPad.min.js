rjdci.signatureListener=a=>{a.target.classList.add("red"),setTimeout(()=>{a.target.classList.remove("red")},3e3);let b,c,d,e=rjdci.getClosest(a.target,".sortable"),f=e.querySelector(".printName"),g=rjdci.getClosest(a.target,".page"),h=document.createElement("canvas"),i=document.createElement("button"),j=document.createElement("button"),k=document.createElement("button"),l=document.createDocumentFragment();if(sigButtonsParent=document.createElement("p"),sigButtonsParent.style.display="flex",h.id="sig",l.appendChild(h),i.innerHTML="Clear",i.classList.add("sigButton"),i.addEventListener("click",()=>{c.clear()}),sigButtonsParent.appendChild(i),k.innerHTML="Cancel",k.addEventListener("click",()=>{b.classList.remove("field"),b.classList.add("sigField"),b.id="",b.innerHTML="",f.required=""!==e.querySelector("input[name='sigImage']").value||"true"===f.getAttribute("data-required").toLowerCase,Array.from(g.querySelectorAll("button")).forEach(a=>{a.disabled=!1}),Array.from(g.querySelectorAll(".printName, .notes")).forEach(a=>{a.readOnly=!1})}),sigButtonsParent.appendChild(k),j.innerHTML="OK",j.classList.add("sigButton"),j.addEventListener("click",()=>{c.isEmpty()?(e.querySelector("input[name='sigImage']").value="",rjdci.toast("Signature Cleared.")):e.querySelector("input[name='sigImage']").value=c.toDataURL(),b.classList.remove("field"),b.classList.add("sigField"),b.id="",b.innerHTML="",f.required=""!==e.querySelector("input[name='sigImage']").value||"true"===f.getAttribute("data-required").toLowerCase,Array.from(g.querySelectorAll("button")).forEach(a=>{a.disabled=!1}),Array.from(g.querySelectorAll(".printName, .notes")).forEach(a=>{a.readOnly=!1})}),sigButtonsParent.appendChild(j),l.appendChild(sigButtonsParent),Array.from(g.querySelectorAll("button")).forEach(a=>{a.disabled=!0}),Array.from(g.querySelectorAll(".printName, .notes")).forEach(a=>{a.readOnly=!0}),b=e.querySelector(".signature-pad"),d=e.getBoundingClientRect(),h.style.width=d.width+"px",h.style.height=.65*d.height+"px",null!==e.querySelector(".tickets")){let a=e.querySelector(".tickets").getBoundingClientRect();a.height}b.classList.remove("sigField"),b.classList.add("field"),b.id="signature-pad",b.appendChild(l),c=new SignaturePad(h),c.velocityFilterWeight=.7,c.minWidth=.5,c.maxWidth=2,c.penColor="red",c.backgroundColor="rgba(0,0,0,1)",resizeCanvas=()=>{let a=Math.max(window.devicePixelRatio||1,1);h.width=h.offsetWidth*a,h.height=h.offsetHeight*a,h.getContext("2d").scale(a,a)},resizeCanvas(),window.scroll(0,rjdci.findPos(document.getElementById("sig"))),c.clear(),h.addEventListener("touchstart",()=>{rjdci.disable_scroll(),rjdciSwipe.disable()}),h.addEventListener("touchend",()=>{rjdci.enable_scroll(),rjdciSwipe.enable()})},rjdci.findPos=a=>{let b=0;if(a.offsetParent){do b+=a.offsetTop;while(a=a.offsetParent);return b-document.getElementsByTagName("header")[0].offsetHeight}},document.addEventListener("rjdci_loaded",()=>{if(document.querySelector("#route")){Array.from(document.querySelectorAll(".getSig")).forEach(a=>{a.addEventListener("click",a=>{rjdci.signatureListener(a)}),rjdci.getClosest(a,".sortable").querySelector(".printName").setAttribute("data-required",rjdci.getClosest(a,".sortable").querySelector(".printName").required)});let a={attributes:!1,childList:!0,subtree:!1},b=new MutationObserver(a=>{for(let b of a){if("childList"!==b.type)return;b.addedNodes.forEach(a=>{Array.from(a.querySelectorAll(".getSig")).forEach(a=>{a.classList.contains("assigned")||(a.classList.add("assigned"),a.addEventListener("click",a=>{rjdci.signatureListener(a)}),rjdci.getClosest(a,".sortable").querySelector(".printName").setAttribute("data-required",rjdci.getClosest(a,".sortable").querySelector(".printName").required))})})}});b.observe(document.querySelector("#route"),a),b.observe(document.querySelector("#on_call"),a)}});
