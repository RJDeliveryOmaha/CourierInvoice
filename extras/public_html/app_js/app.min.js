!function(){let e=screen.width,t=screen.height;setInterval(()=>{screen.width===e&&screen.height===t||(e=screen.width,t=screen.height,rjdci.resolutionchange&&document.dispatchEvent(rjdci.resolutionchange))},250)}(),(e=>{!function(e,t){"function"==typeof define&&define.amd?define([],function(){return e.Swipe=t(),e.Swipe}):"object"==typeof module&&module.exports?module.exports=t():e.Swipe=t()}(this,function(){var t,r="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||this,n=r.document;function o(e,t){"use strict";var o,a,l={},i={},c=(t=t||{}).auto||0,s=!1,u=function(){},d=function(e){setTimeout(e||u,0)},m=function(e){return!!e&&("boolean"!=typeof e.cancelable||e.cancelable)},y={addEventListener:!!r.addEventListener,passiveEvents:function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});r.addEventListener("testEvent",null,t),r.removeEventListener("testEvent",null,t)}catch(t){e=!1}return e}(),touch:"ontouchstart"in r||r.DocumentTouch&&n instanceof DocumentTouch,transitions:function(e){var t=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var r in t)if(void 0!==e.style[t[r]])return!0;return!1}(n.createElement("swipe"))};if(e){var f,h,g,p,v=e.children[0],S=parseInt(t.startSlide,10)||0,q=t.speed||300;t.continuous=void 0===t.continuous||t.continuous;var T,L,E,b=(L="direction",(T=e).currentStyle?E=T.currentStyle[L]:r.getComputedStyle&&(E=r.getComputedStyle(T,null).getPropertyValue(L)),"rtl"===E?"right":"left");t.autoRestart=void 0!==t.autoRestart&&t.autoRestart;var A=function(e,t){t=t||100;var r=null;function n(){r&&clearTimeout(r)}function o(){var o=this,a=arguments;n(),r=setTimeout(function(){r=null,e.apply(o,a)},t)}return o.cancel=n,o}(C),k={handleEvent:function(e){if(!s){switch(e.type){case"mousedown":case"touchstart":this.start(e);break;case"mousemove":case"touchmove":this.move(e);break;case"mouseup":case"mouseleave":case"touchend":this.end(e);break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":this.transitionEnd(e);break;case"resize":A()}t.stopPropagation&&e.stopPropagation()}},start:function(e){var t;F(e)?(t=e).preventDefault():t=e.touches[0],l={x:t.pageX,y:t.pageY,time:+new Date},o=void 0,i={},F(e)?(v.addEventListener("mousemove",this,!1),v.addEventListener("mouseup",this,!1),v.addEventListener("mouseleave",this,!1)):(v.addEventListener("touchmove",this,!!y.passiveEvents&&{passive:!1}),v.addEventListener("touchend",this,!1))},move:function(e){var r;if(F(e))r=e;else{if(1<e.touches.length||e.scale&&1!==e.scale)return;t.disableScroll&&m(e)&&e.preventDefault(),r=e.touches[0]}i={x:r.pageX-l.x,y:r.pageY-l.y},void 0===o&&(o=!!(o||Math.abs(i.x)<Math.abs(i.y))),o||(m(e)&&e.preventDefault(),P(),t.continuous?(O(R(S-1),i.x+h[R(S-1)],0),O(S,i.x+h[S],0),O(R(S+1),i.x+h[R(S+1)],0)):(i.x=i.x/(!S&&0<i.x||S===f.length-1&&i.x<0?Math.abs(i.x)/g+1:1),O(S-1,i.x+h[S-1],0),O(S,i.x+h[S],0),O(S+1,i.x+h[S+1],0)))},end:function(e){var r=+new Date-l.time,n=Number(r)<250&&20<Math.abs(i.x)||Math.abs(i.x)>g/2,a=!S&&0<i.x||S===f.length-1&&i.x<0;t.continuous&&(a=!1);var c=Math.abs(i.x)/i.x;o||(n&&!a?(S=c<0?(t.continuous?(N(R(S-1),-g,0),N(R(S+2),g,0)):N(S-1,-g,0),N(S,h[S]-g,q),N(R(S+1),h[R(S+1)]-g,q),R(S+1)):(t.continuous?(N(R(S+1),g,0),N(R(S-2),-g,0)):N(S+1,g,0),N(S,h[S]+g,q),N(R(S-1),h[R(S-1)]+g,q),R(S-1)),x(K(),f[S],c)):t.continuous?(N(R(S-1),-g,q),N(S,0,q),N(R(S+1),g,q)):(N(S-1,-g,q),N(S,0,q),N(S+1,g,q))),F(e)?(v.removeEventListener("mousemove",k,!1),v.removeEventListener("mouseup",k,!1),v.removeEventListener("mouseleave",k,!1)):(v.removeEventListener("touchmove",k,!!y.passiveEvents&&{passive:!1}),v.removeEventListener("touchend",k,!1))},transitionEnd:function(e){parseInt(e.target.getAttribute("data-index"),10)===S&&((c||t.autoRestart)&&Q(),D(K(),f[S]))}};return C(),I(),{setup:C,slide:function(e,t){P(),_(e,t)},prev:function(){P(),s||(t.continuous?_(S-1):S&&_(S-1))},next:function(){P(),H()},restart:Q,stop:P,getPos:K,disable:function(){P(),s=!0},enable:function(){s=!1,Q()},getNumSlides:function(){return p},kill:function(){P(),e.style.visibility="",v.style.width="",v.style[b]="";for(var t=f.length;t--;){y.transitions&&O(t,0,0);var r=f[t];if(r.getAttribute("data-cloned"))r.parentElement.removeChild(r);r.style.width="",r.style[b]="",r.style.webkitTransitionDuration=r.style.MozTransitionDuration=r.style.msTransitionDuration=r.style.OTransitionDuration=r.style.transitionDuration="",r.style.webkitTransform=r.style.msTransform=r.style.MozTransform=r.style.OTransform=""}M(),A.cancel()}}}function M(){y.addEventListener?(v.removeEventListener("touchstart",k,!!y.passiveEvents&&{passive:!0}),v.removeEventListener("mousedown",k,!1),v.removeEventListener("webkitTransitionEnd",k,!1),v.removeEventListener("msTransitionEnd",k,!1),v.removeEventListener("oTransitionEnd",k,!1),v.removeEventListener("otransitionend",k,!1),v.removeEventListener("transitionend",k,!1),r.removeEventListener("resize",k,!1)):r.onresize=null}function w(e){var t=e.cloneNode(!0);v.appendChild(t),t.setAttribute("data-cloned",!0),t.removeAttribute("id")}function C(n){if(null!=n)for(var o in n)t[o]=n[o];f=v.children,p=f.length;for(var a=0;a<f.length;a++)f[a].getAttribute("data-cloned")&&p--;if(f.length<2&&(t.continuous=!1),y.transitions&&t.continuous&&f.length<3&&(w(f[0]),w(f[1]),f=v.children),"right"===b)for(var l=0;l<f.length;l++)f[l].style.float="right";h=new Array(f.length),g=e.getBoundingClientRect().width||e.offsetWidth,v.style.width=f.length*g*2+"px";for(var i=f.length;i--;){var c=f[i];c.style.width=g+"px",c.setAttribute("data-index",i),y.transitions&&(c.style[b]=i*-g+"px",N(i,i<S?-g:S<i?g:0,0))}t.continuous&&y.transitions&&(N(R(S-1),-g,0),N(R(S+1),g,0)),y.transitions||(v.style[b]=S*-g+"px"),e.style.visibility="visible",M(),y.addEventListener?(y.touch&&v.addEventListener("touchstart",k,!!y.passiveEvents&&{passive:!0}),t.draggable&&v.addEventListener("mousedown",k,!1),y.transitions&&(v.addEventListener("webkitTransitionEnd",k,!1),v.addEventListener("msTransitionEnd",k,!1),v.addEventListener("oTransitionEnd",k,!1),v.addEventListener("otransitionend",k,!1),v.addEventListener("transitionend",k,!1)),r.addEventListener("resize",k,!1)):r.onresize=A}function H(){s||(t.continuous?_(S+1):S<f.length-1&&_(S+1))}function x(e,r,n){t.callback&&t.callback(e,r,n)}function D(e,r){t.transitionEnd&&t.transitionEnd(e,r)}function R(e){return(f.length+e%f.length)%f.length}function K(){var e=S;return p<=e&&(e-=p),e}function _(e,r){if(e="number"!=typeof e?parseInt(e,10):e,S!==e){if(y.transitions){var n=Math.abs(S-e)/(S-e);if(t.continuous){var o=n;(n=-h[R(e)]/g)!==o&&(e=-n*f.length+e)}for(var a=Math.abs(S-e)-1;a--;)N(R((S<e?e:S)-a-1),g*n,0);e=R(e),N(S,g*n,r||q),N(e,0,r||q),t.continuous&&N(R(e-n),-g*n,0)}else e=R(e),function(e,r,n){if(!n)return v.style[b]=r+"px";var o=+new Date,a=setInterval(function(){var l=+new Date-o;if(n<l)return v.style[b]=r+"px",(c||t.autoRestart)&&Q(),D(K(),f[S]),void clearInterval(a);v.style[b]=(r-e)*(Math.floor(l/n*100)/100)+e+"px"},4)}(S*-g,e*-g,r||q);S=e,d(function(){x(K(),f[S],n)})}}function N(e,t,r){O(e,t,r),h[e]=t}function O(e,t,r){var n=f[e],o=n&&n.style;o&&(o.webkitTransitionDuration=o.MozTransitionDuration=o.msTransitionDuration=o.OTransitionDuration=o.transitionDuration=r+"ms",o.webkitTransform=o.msTransform=o.MozTransform=o.OTransform=o.transform="translateX("+t+"px)")}function I(){(c=t.auto||0)&&(a=setTimeout(H,c))}function P(){c=0,clearTimeout(a)}function Q(){P(),I()}function F(e){return/^mouse/.test(e.type)}}return(r.jQuery||r.Zepto)&&((t=r.jQuery||r.Zepto).fn.Swipe=function(e){return this.each(function(){t(this).data("Swipe",new o(t(this)[0],e))})}),o}),function(e,t){"undefined"!=typeof module?module.exports=t():"function"==typeof define&&"object"==typeof define.amd?define(t):this.domready=t()}(0,function(){var e,t=[],r="object"==typeof document&&document,n=r&&r.documentElement.doScroll,o="DOMContentLoaded",a=r&&(n?/^loaded|^c/:/^loaded|^i|^c/).test(r.readyState);return!a&&r&&r.addEventListener(o,e=function(){for(r.removeEventListener(o,e),a=1;e=t.shift();)e()}),function(e){a?setTimeout(e,0):t.push(e)}}),rjdciSwipe=new Swipe(document.querySelector("#slider"),{startSlide:0,speed:300,draggable:!1,continuous:!0,autoRestart:!1,disablescroll:!1,stopPropagation:!1,callback:function(e,t,r){},transitionEnd:function(e,t){let r,n=["Route","On Call","Dispatch","Transfers","Ticket Entry"];document.querySelector(".menu__list__active").classList.remove("menu__list__active"),Array.from(document.querySelectorAll(".page")).forEach(e=>{if(e.id===t.id?e.classList.add("active"):e.classList.remove("active"),e.id===t.id){let t=document.querySelector("a.nav[data-id='"+e.id+"']").innerHTML.split("<");-1!==n.indexOf(t[0])?(r='<button type="button" onclick="rjdci.refresh'+t[0].replace(/\s/g,"")+'()">'+t[0]+"</button>",r+="Route"===t[0]?"":"<"+t[1]+"<"+t[2]):r=document.querySelectorAll("[data-id='"+e.id+"']")[0].innerHTML,document.querySelector(".pageTitle").innerHTML=r,document.querySelector("a.nav[data-id='"+e.id+"']").parentNode.classList.add("menu__list__active")}}),scroll(0,0),document.dispatchEvent(rjdci.pageChange)}})})(window),function(e,t){const r=document.createElement("div");r.classList.add("showbox"),r.innerHTML='\x3c!-- New spinner from http://codepen.io/collection/HtAne/ --\x3e<div class="loader"><svg class="circular" viewBox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/></svg></div>',e.loggedout=new Event("rjdci_loggedout"),e.loggedin=new Event("rjdci_loggedin"),e.resolutionchange=new Event("rjdci_resolutionchange"),e.loaded=new Event("rjdci_loaded"),e.pageChange=new Event("rjdci_pageChange"),e.triggerEvent=((e,t)=>{if(document.createEvent){let r=document.createEvent("HTMLEvents");return r.initEvent(t,!0,!0),e.dispatchEvent(r)}if(e.fireEvent)return e.fireEvent("on"+t)}),e.updateMap=(({coords1:e,address1:t,coords2:r,address2:n,center:o,mapDivID:a})=>!1),ucfirst=(e=>e.charAt(0).toUpperCase()+e.slice(1)),lcfirst=(e=>e.charAt(0).toLowerCase()+e.slice(1)),e.logout=(t=>{let r=t||0;if(!document.querySelector("#uid").value.match(/(driver|dispatch)\d+/))return document.querySelector("#logoutLink").submit();e.fetch_template({url:"./logout",postData:{logout:1,formKey:document.querySelector("#formKey").value}}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1!==t.indexOf("error"))return r++,e.logout(r);document.querySelector("#logoutLink").submit()}).catch(t=>(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,++r>5?document.querySelector("#logoutLink").submit():e.logout(r)))});let n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];e.toast=((t,r)=>{if(!t)return;let a=document.querySelector(".toast__container");(r=r||{}).title=r.title||"",r.time=r.time||4e3,r.eleClass=r.eleClass||"toast__msg",r.datatime=r.datatime||(new Date).getTime();let l=document.createElement("div");l.className=r.eleClass,l.title=r.title;let i=new Date(Number(r.datatime)),c=i.getMinutes();if(c=c<10?`0${c.toString()}`:c.toString(),l.innerHTML=`${t} <p>${o[i.getDay()]} ${n[i.getMonth()]} ${i.getDate()}</p><p>${i.getHours()}:${c}</p>`,l.setAttribute("data-time",r.datatime),"deliveryLocation"===l.className&&l.addEventListener("click",t=>"DIV"===t.target.tagName.toUpperCase()?t.target.parentNode.removeChild(t.target):e.triggerEvent(e.getClosest(t.target,"div"),"click")),"toast__msg"!==r.eleClass){for(let e=0;e<a.children.length;e++)if(a.children[e].classList.contains(r.eleClass)){let t=a.children[e];t.parentNode.removeChild(t)}a.appendChild(l)}else a.appendChild(l);setTimeout(()=>{l.classList.contains("toast__msg")&&l.classList.add("toast__msg--hide")},r.time),setTimeout(()=>{for(let e=0;e<a.children.length;e++){let t=a.children[e];t.classList.contains("toast__msg")&&t.parentNode.removeChild(t)}},r.time+1e3)}),e.getClosest=function(e,t){for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),r=t.length;--r>=0&&t.item(r)!==this;);return r>-1});e&&e!==document;e=e.parentNode)if(e.matches(t))return e;return null},pause=(e=>new Promise(t=>setTimeout(t,e))),e.fetch_template=(async({url:t,postData:r={},method:n="POST",retry:o=0})=>{if(!t)throw new Error("URL not defined");let a={method:n.toUpperCase()};Object.keys(r).length>0&&(a.headers={"Content-Type":"application/json"},a.body=JSON.stringify(r));try{return await fetch(t,a)}catch(a){if(20===++o)throw a;return await pause(250*o),await e.fetch_template({url:t,postData:r,method:n,retry:o})}}),e.showLogin=(()=>{let t=document.getElementById("confirmLogin");t.offsetWidth>0&&t.offsetHeight>0||t.classList.remove("hide"),e.centerForm(t),document.dispatchEvent(e.loggedout)}),e.enableApp=(()=>{document.querySelector("header").classList.remove("loggedout"),document.querySelector(".menu__header").classList.remove("loggedoutHeader"),Array.from(document.querySelectorAll("button")).forEach(e=>{e.disabled=!1})}),e.disableApp=(()=>{let e=document.querySelector("header"),t=document.querySelector(".menu__header");if(void 0===e||void 0===t||e.classList.contains("loggedout"))return!1;e.classList.add("loggedout"),t.classList.add("loggedoutHeader"),Array.from(document.querySelectorAll("button")).forEach(e=>{"confirm"!==e.id&&"cancel"!==e.id&&(e.disabled=!0)})}),e.isTarget=(e=>{let t=["billTo","dispatchedTo","dispatchedByUser","shippingCountry","billingCountry","pCountry","dCountry"];for(let r=0;r<t.length;r++)if(e.classList.contains(t[r]))return!0;return!1}),e.disableButtonsTickets=(()=>{let e=0,t=document.querySelectorAll("#ticket_query .orgMember"),r=document.querySelector("#compareMembersTickets");for(let r=0;r<t.length;r++)!0===t[r].checked&&e++;r.disabled=!(e>1&&"chart"===document.querySelector("#display").value),!0===r.disabled&&(r.checked=!1)}),e.disable_scroll=(()=>{window.ontouchmove=(e=>e.preventDefault())}),e.enable_scroll=(()=>{window.ontouchmove=(e=>!0)}),e.fixDeadRunButton=(()=>{let e=document.querySelector(".cancelRun:not(.hide)");if(!e)return;let t=e.offsetHeight;Array.from(document.querySelectorAll(".deadRun")).forEach(e=>{e.innerHTML="Dead Run",e.offsetHeight>t&&(e.innerHTML="D. Run")})}),e.centerForm=(e=>{let t=(document.body.getBoundingClientRect().width-e.getBoundingClientRect().width)/2;e.style.left=t+"px"}),isStopBeforeNoon=(e=>{return timestamp=1e3*Number(e.querySelector(".timing").innerText),new Date(timestamp).getHours()<12}),isStopAfterNoon=(e=>{return timestamp=1e3*Number(e.querySelector(".timing").innerText),new Date(timestamp).getHours()>=12}),sortRoute=(()=>{let e,t=document.querySelector("#route"),r=document.getElementById("overnightFlag")?document.getElementById("overnightFlag").innerText:0,n=Array.from(t.querySelectorAll(".sortable")).filter(isStopBeforeNoon),o=Array.from(t.querySelectorAll(".sortable")).filter(isStopAfterNoon);n.sort((e,t)=>e.querySelector(".timing").textContent>t.querySelector(".timing").textContent?1:-1),o.sort((e,t)=>e.querySelector(".timing").textContent>t.querySelector(".timing").textContent?1:-1),e="1"===r?[...o,...n]:[...n,...o];let a=document.createDocumentFragment();e.forEach(e=>{a.appendChild(e)}),t.appendChild(a)}),e.refreshRoute=(async()=>{let t=r.cloneNode(!0);document.querySelector("#route").innerHTML="",document.querySelector("#route").appendChild(t),scrollTo(0,0),await e.fetch_template({url:"./refreshRoute.php",postData:{formKey:document.querySelector("#formKey").value}}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(r=>{if(-1!==r.indexOf("Session Error"))return document.querySelector("#function").value="refreshRoute",e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1!==r.indexOf("error"))throw new Error(r);let n=(new DOMParser).parseFromString(r,"text/html"),o=document.createDocumentFragment();Array.from(n.querySelectorAll(".sortable, .result, #overnightFlag")).forEach(e=>{o.appendChild(e)}),setTimeout(()=>{document.querySelector("#route").removeChild(t),document.querySelector("#route").appendChild(o),e.assignListeners(),e.fixDeadRunButton(),sortRoute()},2e3)}).catch(e=>{document.querySelector("#route").innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>"})}),countOnCallTickets=(e=>{let t=Array.from(document.querySelectorAll("#on_call .tickets")).length;t>e&&(document.querySelector(".alert").classList.add("onCallAlert"),document.querySelector(".alert").innerHTML="!",document.querySelector("#newUpdate").classList.remove("hide")),0===t&&document.querySelector(".alert").classList.remove("onCallAlert"),1===document.querySelector(".alert").getAttribute("class").split(/\s+/).length&&(document.querySelector(".alert").innerHTML=""),Array.from(document.querySelectorAll(".ticketCount")).forEach(e=>{e.innerHTML=t})}),sortOnCall=(()=>{let e=document.querySelector("#on_call"),t=Array.from(e.querySelectorAll(".sortable"));t.sort((e,t)=>e.querySelector(".timing").textContent>t.querySelector(".timing").textContent?1:-1);let r=document.createDocumentFragment();t.forEach(e=>{r.appendChild(e)}),e.appendChild(r)}),e.refreshOnCall=(async()=>{let t=document.querySelector(".ticketCount").innerHTML,n=r.cloneNode(!0);document.querySelector("#on_call").innerHTML="",document.querySelector("#on_call").appendChild(n),scrollTo(0,0),await e.fetch_template({url:"./refreshOnCall.php",postData:{formKey:document.querySelector("#formKey").value}}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(r=>{if(-1!==r.indexOf("Session Error"))return document.querySelector("#function").value="refreshOnCall",e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1!==r.indexOf("error"))throw new Error(r);let o=(new DOMParser).parseFromString(r,"text/html"),a=document.createDocumentFragment();Array.from(o.querySelectorAll(".sortable, .result")).forEach(e=>{a.appendChild(e)}),setTimeout(()=>{document.querySelector("#on_call").removeChild(n),document.querySelector("#on_call").appendChild(a),e.assignListeners(),e.fixDeadRunButton(),sortOnCall(),countOnCallTickets(t)},2e3)}).catch(e=>{console.error(e.message),document.querySelector("#on_call").innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>"})}),countInitOnCall=(()=>{let e=Array.from(document.querySelectorAll("#on_call .tickets")).length;Array.from(document.querySelectorAll(".ticketCount")).forEach(t=>{t.innerHTML=e}),e>0&&(document.querySelector(".alert").classList.add("onCallAlert"),document.querySelector(".alert").innerHTML="!")}),e.refreshTicketEntry=(async()=>{let t=document.querySelector("#deliveryRequest"),n=t.parentNode;target=n.querySelector(".subContainer"),localSpinner=r.cloneNode(!0),n.removeChild(target),n.removeChild(t),n.appendChild(localSpinner),scrollTo(0,0),await e.fetch_template({url:"./refreshTicketForm.php",postData:{edit:1,formKey:document.querySelector("#formKey").value}}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(-1!==t.indexOf("Session Error"))return document.querySelector("#function").value="refreshTicketForm",e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1!==t.indexOf("error"))throw new Error(t);let r=(new DOMParser).parseFromString(t,"text/html"),o=document.createDocumentFragment();Array.from(r.querySelectorAll("#deliveryRequest")).forEach(e=>{o.appendChild(e)}),setTimeout(()=>{n.removeChild(localSpinner),n.appendChild(o),n.appendChild(target),e.assignListeners()},2e3)}).catch(e=>{n.innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>",target.classList.remove("hide")})}),e.countDispatch=(e=>{let t=document.querySelector("#dispatch .tickets")?Array.from(document.querySelectorAll("#dispatch .tickets")).length:0,r=document.querySelector(".alert");t>e&&(r.classList.add("dispatchAlert"),r.innerHTML="!"),0===t&&r.classList.remove("dispatchAlert"),1===r.classList.length&&(r.innerHTML=""),Array.from(document.querySelectorAll(".dispatchCount")).forEach(e=>{e.innerHTML=t})}),e.refreshDispatch=(async()=>{let t=Number(document.querySelector(".dispatchCount").innerHTML)-1,n=r.cloneNode(!0);document.querySelector("#dispatch").innerHTML="",document.querySelector("#dispatch").appendChild(n),scrollTo(0,0),await e.fetch_template({url:"./refreshDispatch.php",postData:{formKey:document.querySelector("#formKey").value}}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(r=>{if(-1!==r.indexOf("Session Error"))return document.querySelector("#function").value="refreshDispatch",e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1!==r.indexOf("error"))throw new Error(r);let o=(new DOMParser).parseFromString(r,"text/html"),a=document.createDocumentFragment();Array.from(o.querySelectorAll(".sortable, .result")).forEach(e=>{a.appendChild(e)}),setTimeout(()=>{document.querySelector("#dispatch").removeChild(n),document.querySelector("#dispatch").appendChild(a),e.assignListeners(),e.countDispatch(t),Array.from(document.querySelectorAll("#dispatch .dTicket")).forEach(t=>{t.onclick=e.stepTicket()})},2e3)}).catch(e=>{document.querySelector("#dispatch").innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>"})}),countInitDispatch=(()=>{let e=Array.from(document.querySelectorAll("#dispatch .tickets")).length;Array.from(document.querySelectorAll(".dispatchCount")).forEach(t=>{t.innerHTML=e}),e>0&&(document.querySelector(".alert").classList.add("dispatchAlert"),document.querySelector(".alert").innerHTML="!")}),countTransferTickets=(e=>{let t=Array.from(document.querySelectorAll("#transfers .sortable")).length,r=document.querySelector(".alert");t>e&&(r.classList.add("transfersAlert"),r.innerHTML="!",document.querySelector("#newUpdate").classList.remove("hide")),0===t&&r.classList.remove("transfersAlert"),1===r.classList.length&&(r.innerHTML=""),Array.from(document.querySelectorAll(".transfersCount")).forEach(e=>{e.innerHTML=t})}),e.refreshTransfers=(async()=>{let t=document.querySelector(".transfersCount").innerHTML,n=r.cloneNode(!0);document.querySelector("#transfers").innerHTML="",document.querySelector("#transfers").appendChild(n),scrollTo(0,0),await e.fetch_template({url:"./refreshTransfers.php",postData:{formKey:document.querySelector("#formKey").value}}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(r=>{if(-1!==r.indexOf("Session Error"))return document.querySelector("#function").value="refreshTransfers",e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1!==r.indexOf("error"))throw new Error(r);let o=(new DOMParser).parseFromString(r,"text/html"),a=document.createDocumentFragment();Array.from(o.querySelectorAll(".sortable, .result")).forEach(e=>{a.appendChild(e)}),setTimeout(()=>{document.querySelector("#transfers").removeChild(n),document.querySelector("#transfers").appendChild(a),e.assignListeners(),countTransferTickets(t)},2e3)}).catch(e=>{document.querySelector("#transfers").innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>"})}),countInitTransfers=(()=>{let e=Array.from(document.querySelectorAll("#transfers .sortable")).length;Array.from(document.querySelectorAll(".transfersCount")).forEach(t=>{t.innerHTML=e}),e>0&&(document.querySelector(".alert").classList.add("transfersAlert"),document.querySelector(".alert").innerHTML="!")}),e.assignLinkValues=(()=>{let e,t=document.getElementsByClassName("nav"),r=["Route","On Call","Dispatch","Transfers","Ticket Entry"];for(let n=0;n<t.length;n++)if(t[n].setAttribute("data-value",n),0===n){let o=t[n].innerHTML.split("<");-1!==r.indexOf(o[0])?(e='<button type="button" onclick="rjdci.refresh'+o[0].replace(/\s/g,"")+'()">'+o[0]+"</button>",e+="Route"===o[0]?"":"<"+o[1]+"<"+o[2]):e=t[n].innerHTML,document.querySelector(".pageTitle").innerHTML=e}}),e.populatePage=(async()=>{let t=[];Array.from(document.querySelectorAll(".page")).forEach((e,r)=>{void 0!==e.getAttribute("data-function")&&""!==e.getAttribute("data-function")&&t.push(e.getAttribute("data-function"))}),await e.fetch_template({url:"./initApp.php",postData:{functions:t,formKey:document.querySelector("#formKey").value}}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(-1!==t.indexOf("Session Error"))return document.getElementById("function").value="populatePage",e.showLogin();document.getElementById("formKey").value=Number(document.getElementById("formKey").value)+1;let r;try{r=JSON.parse(t)}catch(e){throw e.message=e.message+"\n"+t,e}for(let e=0;e<r.length;e++)document.querySelectorAll(".page").forEach((t,n)=>{Number(t.getAttribute("data-index"))===e&&(t.innerHTML=r[e])});scrollTo(0,0),null!==document.getElementById("route")&&sortRoute(),null!==document.getElementById("on_call")&&(sortOnCall(),countInitOnCall()),null!==document.getElementsByClassName("deadRun")&&e.fixDeadRunButton(),null!==document.getElementById("dispatch")&&countInitDispatch(),null!==document.getElementById("transfers")&&countInitTransfers()}).catch(e=>{Array.from(document.querySelectorAll(".page")).forEach(t=>{t.innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>"})})}),e.deliveryLocation=(({ticket_index:t=[],step:r=[]})=>{if(void 0===navigator.permissions||void 0===navigator.geolocation)return e.toast("Location Not Available");let n=0,o=0,a=null,l=!1,i={title:"Updating Location",eleClass:"deliveryLocation"};e.toast("Updating Location<br>Do not<br>disable screen",i),navigator.permissions.query({name:"geolocation"}).then(c=>{let s={enableHighAccuracy:!0,timeout:25e3,maximumAge:0},u=e=>{if(console.log(e),l=++n>1&&l&&l.coords.accuracy<e.coords.accuracy?l:e,n>5||n>2&&l.coords.accuracy<10)return navigator.geolocation.clearWatch(a),m(l)},d=t=>{if(o++,e.toast("Location Not Available<br>"+t.message+"<br>Tap to dismiss",i),n>5||o>5)return navigator.geolocation.clearWatch(a),m(l)},m=async n=>{if(!n)return e.toast("Location Not Available<br>Tap to dismiss",i);if(t.length!==r.length||0===t.length)return e.toast("Location Data Error<br>Tap to dismiss",i);let o={},a={};o.formKey=document.querySelector("#formKey").value,t.length>1?(o.multiTicket=[],t.forEach((e,t)=>{a.ticket_index=e,a[r[t]+"Lat"]=n.coords.latitude,a[r[t]+"Lng"]=n.coords.longitude,o.multiTicket[t]=a,a={}})):(o.ticket_index=t[0],o[r[0]+"Lat"]=n.coords.latitude,o[r[0]+"Lng"]=n.coords.longitude),await e.fetch_template({url:"./updateTicket.php",postData:o}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(-1!==t.indexOf("Session Error"))throw new Error("Session Error");if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1!==t.indexOf("error"))throw new Error(t);return e.toast("Location Updated<br>Tap to dismiss",i)}).catch(t=>(console.error(t.message),e.toast(t.message+"<br>Tap to dismiss",i)))};if("granted"==c.state)a=navigator.geolocation.watchPosition(u,d,s);else if("prompt"==c.state)navigator.geolocation.getCurrentPosition(e=>{});else if("denied"==c.state)return!1;c.onchange=(()=>{if("granted"===c.state)a=navigator.geolocation.watchPosition(u,d,s);else{if("prompt"==c.state)return!1;if("denied"==c.state)return!1}})})}),getCancelThis=(()=>{let t=document.createElement("button");return t.type="button",t.innerHTML="Go Back",t.classList.add("cancelThis"),t.onclick=(t=>{e.cancelThis(t)}),t}),e.cancelThis=(t=>{let r=e.getClosest(t.target,".sortable");Array.from(r.querySelectorAll("button")).forEach(e=>{e.disabled=!1}),t.target.parentNode.innerHTML=""}),getStepTicket=(t=>{let r=document.createElement("button");return r.type="button",r.innerHTML="Confirm",r.classList.add("stepTicket"),r.setAttribute("form",t),r.onclick=(t=>{e.stepTicket(t)}),r}),e.stepTicket=(async t=>{t.preventDefault();let r={},n=!1,o="",a=e.getClosest(t.target,".message2"),l=e.getClosest(t.target,".page").getAttribute("id"),i=document.createElement("span");if(null===a&&(a=e.getClosest(t.target,"form").querySelector(".message2")),Array.from(document.querySelectorAll("input[form="+t.target.getAttribute("form")+"], textarea[form="+t.target.getAttribute("form")+"]")).forEach(e=>{"latitude"!==e.getAttribute("name")&&"longitude"!==e.getAttribute("name")&&(!0===e.required&&""===e.value&&(n=!0,e.classList.add("elementError"),setTimeout(()=>{e.classList.remove("elementError")},3e3)),r[e.getAttribute("name")]=e.value)}),r.formKey=document.querySelector("#formKey").value,n)return;i.classList.add("ellipsis"),i.innerHTML=".",a.innerHTML="",a.appendChild(i);let c=!0,s=setInterval(()=>{!0===c&&(i.innerHTML+="..",c=i.innerHTML.length<21&&1!=i.innerHTML.length),!1===c&&(i.innerHTML=i.innerHTML.substr(0,i.innerHTML.length-2),c=1===i.innerHTML.length)},500);switch(r.hasOwnProperty("pSigPrint")&&(r.printName=r.pSigPrint,delete r.pSigPrint),r.hasOwnProperty("dSigPrint")&&(r.printName=r.dSigPrint,delete r.dSigPrint),r.hasOwnProperty("d2SigPrint")&&(r.printName=r.d2SigPrint,delete r.d2SigPrint),document.querySelector('.step[form="'+t.target.getAttribute("form")+'"]').value){case"pickedUp":o="p";break;case"delivered":o="d";break;case"returned":o="d2"}o&&e.deliveryLocation({ticket_index:[r.ticket_index],step:[o]}),await e.fetch_template({url:"./updateStep.php",postData:r}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(clearInterval(s),-1!==t.indexOf("Session Error"))return e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1!==t.indexOf("error"))throw new Error(t);a.innerHTML=t,setTimeout(()=>{switch(l){case"route":e.refreshRoute();break;case"on_call":e.refreshOnCall();break;case"dispatch":e.refreshDispatch()}},3e3)}).catch(t=>{console.error(t.message),clearInterval(s),a.innerHTML='<p class="center"><span class="error">Error</span>: '+t.message+"</p>",setTimeout(()=>{a.innerHTML="",Array.from(e.getClosest(a,".sortable").querySelectorAll("button")).forEach(e=>{e.disabled=!1})},5e3)})}),getStepAll=(()=>{let t=document.createElement("button");return t.type="button",t.innerHTML="Confirm",t.classList.add("stepAll"),t.onclick=(t=>{e.stepAll(t)}),t}),e.stepAll=(async t=>{t.preventDefault();let r={},n=[],o={},a={step:[],ticket_index:[]},l=e.getClosest(t.target,".message2"),i=e.getClosest(t.target,".sortable"),c=document.createElement("span"),s=i.querySelector(".printName");if(!0===s.required&&""===s.value)return s.classList.add("elementError"),setTimeout(()=>{s.classList.remove("elementError")},3e3),!1;c.classList.add("ellipsis"),c.innerHTML=".",l.innerHTML="",l.appendChild(c);let u=!0,d=setInterval(()=>{!0===u&&(c.innerHTML+="..",u=c.innerHTML.length<21&&1!=c.innerHTML.length),!1===u&&(c.innerHTML=c.innerHTML.substr(0,c.innerHTML.length-2),u=1===c.innerHTML.length)},500);Array.from(i.querySelectorAll(".routeStop")).forEach((e,t)=>{Array.from(document.querySelectorAll("input[form='"+e.getAttribute("id")+"'], textarea[form='"+e.getAttribute("id")+"']")).forEach(e=>{if("latitude"!==e.getAttribute("name")&&"longitude"!==e.getAttribute("name")&&(o[e.getAttribute("name")]=e.value),"step"===e.getAttribute("name"))switch(e.value){case"pickedUp":a.step.push("p");break;case"delivered":a.step.push("d");break;case"returned":a.step.push("d2")}"ticket_index"===e.getAttribute("name")&&a.ticket_index.push(e.value)}),n[t]=o,o={}}),r.multiTicket=n,r.formKey=document.querySelector("#formKey").value,r.printName=s.value,r.sigImage=i.querySelector(".sigImage").value,e.deliveryLocation(a),await e.fetch_template({url:"./updateStep.php",postData:r}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(clearInterval(d),-1!==t.indexOf("Session Error"))return e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1!==t.indexOf("error"))throw new Error(t);l.innerHTML=t,setTimeout(e.refreshRoute,3e3)}).catch(t=>{console.error(t.message),clearInterval(d),l.innerHTML='<p class="center"><span class="error">Error</span>: '+t.message+"</p>",setTimeout(()=>{l.innerHTML="",Array.from(e.getClosest(l,".sortable").querySelectorAll("button")).forEach(e=>{e.disabled=!1})},5e3)})}),getCancelTicket=((t,r)=>{let n=document.createElement("button");return n.type="button",n.innerHTML="Confirm",n.classList.add("confirm"+r),n.setAttribute("form",t),n.onclick=(t=>{e.confirmCancel(t)}),n}),e.confirmCancel=(async t=>{t.preventDefault();let r={},n=["ticket_index","notes","ticketBase"],o=e.getClosest(t.target,".message2"),a="",l=document.createElement("span");l.classList.add("ellipsis"),l.innerHTML=".",o.innerHTML="",o.appendChild(l);let i=!0,c=setInterval(()=>{!0===i&&(l.innerHTML+="..",i=l.innerHTML.length<21&&1!=l.innerHTML.length),!1===i&&(l.innerHTML=l.innerHTML.substr(0,l.innerHTML.length-2),i=1===l.innerHTML.length)},500);switch(Array.from(document.querySelectorAll("input[form="+t.target.getAttribute("form")+"], textarea[form="+t.target.getAttribute("form")+"]")).forEach(e=>{-1!==n.indexOf(e.getAttribute("name"))&&(r[e.getAttribute("name")]=e.value)}),t.target.getAttribute("class")){case"confirmDelete":r.action="delete";break;case"confirmCancelRun":r.action="cancel";break;case"confirmDeadRun":r.action="deadRun",a="p";break;case"confirmDeclined":r.action="declined",a="d"}r.formKey=document.querySelector("#formKey").value,a&&e.deliveryLocation({ticket_index:[r.ticket_index],step:[a]}),await e.fetch_template({url:"./deleteContractTicket.php",postData:r}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(clearInterval(c),-1!==t.indexOf("Session Error"))return e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1!==t.indexOf("error"))throw new Error(t);o.innerHTML=t,setTimeout(async()=>{switch(e.getClosest(o,".page").getAttribute("id")){case"route":return await e.refreshRoute();case"on_call":return await e.refreshOnCall()}},3e3)}).catch(t=>{console.error(t.message),clearInterval(c),o.innerHTML='<p class="center"><span class="error">Error</span>: '+t.message+"</p>",setTimeout(()=>{o.innerHTML="",Array.from(e.getClosest(o,".sortable").querySelectorAll("button")).forEach(e=>{e.disabled=!1})},5e3)})}),getTransferTicket=(t=>{let r=document.createElement("button");return r.type="button",r.innerHTML="Confirm",r.classList.add("confirmTransfer"),r.setAttribute("form",t),r.onclick=(t=>{e.transferTicket(t)}),r}),e.transferTicket=(async t=>{t.preventDefault();let r={},n=e.getClosest(t.target,".message2"),o=e.getClosest(t.target,".tickets"),a=e.getClosest(t.target,".page").getAttribute("id"),l=document.createElement("span");if(l.classList.add("ellipsis"),l.innerHTML=".",r.pendingReceiver=n.querySelector(".pendingReceiver").value,!r.pendingReceiver)return n.querySelector(".pendingReceiver").classList.add("elementError"),setTimeout(()=>{n.querySelector(".pendingReceiver").classList.remove("elementError"),Array.from(n.querySelectorAll("button")).forEach(e=>{e.disabled=!1})},3e3),!1;n.innerHTML="",n.appendChild(l);let i=!0,c=setInterval(()=>{!0===i&&(l.innerHTML+="..",i=l.innerHTML.length<21&&1!=l.innerHTML.length),!1===i&&(l.innerHTML=l.innerHTML.substr(0,l.innerHTML.length-2),i=1===l.innerHTML.length)},500);r.ticket_index=o.querySelector(".ticket_index").value,r.transfers=o.querySelector(".transfers").value,r.notes=o.querySelector(".notes").value,r.action="transfer",r.formKey=document.querySelector("#formKey").value,r.TransferState=1,await e.fetch_template({url:"./deleteContractTicket.php",postData:r}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(clearInterval(c),-1!==t.indexOf("Session Error"))return e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1===t.indexOf("error"))return n.innerHTML=t;throw new Error(t)}).then(async t=>await e.refreshTransfers()).then(async t=>{switch(a){case"route":return await e.refreshRoute();case"on_call":return await e.refreshOnCall()}}).catch(t=>{console.error(t.message),clearInterval(c),n.innerHTML='<p class="center"><span class="error">Error</span>: '+t.message+"</p>",setTimeout(()=>{n.innerHTML="",Array.from(e.getClosest(n,".sortable").querySelectorAll("button")).forEach(e=>{e.disabled=!1})},5e3)})}),getTransferGroup=(t=>{let r=document.createElement("button");return r.type="button",r.innerHTML="Confirm",r.classList.add("confirmTransferGroup"),r.setAttribute("form",t),r.onclick=(t=>{e.transferGroup(t)}),r}),e.transferGroup=(async t=>{let r=[],n={},o={},a=e.getClosest(t.target,".message2"),l=e.getClosest(t.target,".sortable"),i=document.createElement("span");if(i.classList.add("ellipsis"),i.innerHTML=".",pendingReceiver=a.querySelector(".pendingReceiver").value,!pendingReceiver)return a.querySelector(".pendingReceiver").classList.add("elementError"),setTimeout(()=>{a.querySelector(".pendingReceiver").classList.remove("elementError"),Array.from(a.querySelectorAll("button")).forEach(e=>{e.disabled=!1})},3e3),!1;a.innerHTML="",a.appendChild(i);let c=!0,s=setInterval(()=>{!0===c&&(i.innerHTML+="..",c=i.innerHTML.length<21&&1!=i.innerHTML.length),!1===c&&(i.innerHTML=i.innerHTML.substr(0,i.innerHTML.length-2),c=1===i.innerHTML.length)},500);Array.from(l.querySelectorAll(".routeStop")).forEach((e,t)=>{Array.from(document.querySelectorAll("input[form='"+e.getAttribute("id")+"'], textarea[form='"+e.getAttribute("id")+"']")).forEach(e=>{n[e.getAttribute("name")]=e.value}),n.pendingReceiver=pendingReceiver,n.transferState=1,r[t]=n,n={}}),o.multiTicket=r,o.TransferState=1,o.action="transfer",o.formKey=document.querySelector("#formKey").value,await e.fetch_template({url:"./deleteContractTicket.php",postData:o}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(clearInterval(s),-1!==t.indexOf("Session Error"))return e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1===t.indexOf("error"))return a.innerHTML=t;throw new Error(t)}).then(async t=>await e.refreshTransfers()).then(async t=>await e.refreshRoute()).catch(t=>{console.error(t.message),clearInterval(s),a.innerHTML='<p class="center"><span class="error">Error</span>: '+t.message+"</p>",setTimeout(()=>{a.innerHTML="",Array.from(e.getClosest(a,".sortable").querySelectorAll("button")).forEach(e=>{e.disabled=!1})},5e3)})}),getTransferButton=(t=>{let r=document.createElement("button");return r.type="button",r.innerHTML="Confirm",r.classList.add("confirm"+ucfirst(t)),r.onclick=(t=>{e.processTransfer(t)}),r}),e.processTransfer=(async t=>{let r,n=["confirmCancelTransfer","confirmDeclineTransfer","confirmAcceptTransfer"],o={},a=e.getClosest(t.target,".message2"),l=e.getClosest(t.target,".tickets"),i=document.createElement("span");i.classList.add("ellipsis"),i.innerHTML=".",Array.from(l.querySelectorAll("button")).forEach(e=>{e.disabled=!0}),a.innerHTML="",a.appendChild(i);let c=!0,s=setInterval(()=>{!0===c&&(i.innerHTML+="..",c=i.innerHTML.length<21&&1!=i.innerHTML.length),!1===c&&(i.innerHTML=i.innerHTML.substr(0,i.innerHTML.length-2),c=1===i.innerHTML.length)},500);o.formKey=document.querySelector("#formKey").value,o.action="transfer",o.pendingReceiver=0,Array.from(l.querySelectorAll("input, textarea")).forEach(e=>{o[e.getAttribute("name")]=e.value});for(let e=0;e<t.target.classList.length;e++)if(n.indexOf(-1!==t.target.classList[e])){r=t.target.classList[e];break}switch(r){case"confirmCancelTransfer":o.TransferState=2;break;case"confirmDeclineTransfer":o.TransferState=3;break;case"confirmAcceptTransfer":o.TransferState=4}await e.fetch_template({url:"./deleteContractTicket.php",postData:o}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(clearInterval(s),-1!==t.indexOf("Session Error"))return e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1===t.indexOf("error"))return a.innerHTML=t;throw new Error(t)}).then(async t=>"0"===l.querySelector(".rNum").innerText?await e.refreshOnCall():await e.refreshRoute()).then(async t=>await e.refreshTransfers()).catch(e=>{console.error(e.message),clearInterval(s),a.innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>",setTimeout(()=>{a.innerHTML="",Array.from(l.querySelectorAll("button")).forEach(e=>{e.disabled=!1})},5e3)})}),getTransferAllButton=(t=>{let r=document.createElement("button");return r.type="button",r.innerHTML="Confirm",r.classList.add("confirm"+ucfirst(t)),r.onclick=(t=>{e.processTransferAll(t)}),r}),e.processTransferAll=(async t=>{let r,n,o=["confirmCancelTransferGroup","confirmDeclineTransferGroup","confirmAcceptTransferGroup"],a={},l={},i=e.getClosest(t.target,".message2"),c=e.getClosest(t.target,".sortable"),s=document.createElement("span");l.multiTicket=[],l.formKey=document.querySelector("#formKey").value,s.classList.add("ellipsis"),s.innerHTML=".",i.innerHTML="",i.appendChild(s);let u=!0,d=setInterval(()=>{!0===u&&(s.innerHTML+="..",u=s.innerHTML.length<21&&1!=s.innerHTML.length),!1===u&&(s.innerHTML=s.innerHTML.substr(0,s.innerHTML.length-2),u=1===s.innerHTML.length)},500);for(let e=0;e<t.target.classList.length;e++)if(o.indexOf(-1!==t.target.classList[e])){n=t.target.classList[e];break}switch(n){case"confirmCancelTransferGroup":r=2;break;case"confirmDeclineTransferGroup":r=3;break;case"confirmAcceptTransferGroup":r=4}l.TransferState=r,Array.from(c.querySelectorAll(".routeStop")).forEach((e,t)=>{Array.from(document.querySelectorAll("input[form='"+e.getAttribute("id")+"'], textarea[form='"+e.getAttribute("id")+"']")).forEach(e=>{a[e.getAttribute("name")]=e.value}),a.transferState=r,a.action="transfer",l.multiTicket[t]=a,a={}}),await e.fetch_template({url:"./deleteContractTicket.php",postData:l}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(clearInterval(d),-1!==t.indexOf("Session Error"))return e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1===t.indexOf("error"))return i.innerHTML=t;throw new Error(t)}).then(async t=>await e.refreshRoute()).then(async t=>await e.refreshTransfers()).catch(e=>{console.error(e.message),clearInterval(d),i.innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>",setTimeout(()=>{i.innerHTML="",Array.from(c.querySelectorAll("button")).forEach(e=>{e.disabled=!1})},5e3)})}),e.assignListeners=(()=>{if(document.querySelector("#deliveryRequest")&&assignTicketFormListeners(e.getClosest(document.querySelector("#deliveryRequest"),".page")),document.querySelector("form[id^='dispatchForm']")&&Array.from(document.querySelectorAll("form[id^='dispatchForm'] .stepTicket")).forEach(t=>{t.onclick=(t=>{e.stepTicket(t)})}),Array.from(document.querySelectorAll("button")).forEach(e=>{e.addEventListener("click",()=>{e.classList.add("red"),setTimeout(()=>{e.classList.remove("red")},3e3)})}),Array.from(document.querySelectorAll(".dTicket")).forEach(t=>{t.addEventListener("click",t=>{t.preventDefault();let r=e.getClosest(t.target,".page");Array.from(r.querySelectorAll(".cancelThis")).forEach(t=>{e.triggerEvent(t,"click")});let n=e.getClosest(t.target,".tickets");Array.from(n.querySelectorAll("button")).forEach(e=>{e.disabled=!0});let o=n.querySelector(".message2"),a=getCancelThis(),l=getStepTicket(t.target.getAttribute("form"));o.innerHTML="Confirm "+t.target.innerText+":<br>",o.appendChild(l),o.appendChild(a)})}),Array.from(document.querySelectorAll(".confirmAll")).forEach(t=>{t.addEventListener("click",t=>{t.preventDefault();let r=e.getClosest(t.target,".page");Array.from(r.querySelectorAll(".cancelThis")).forEach(t=>{e.triggerEvent(t,"click")});let n=e.getClosest(t.target,".sortable");Array.from(n.querySelectorAll("button")).forEach(e=>{e.disabled=!0});let o=n.querySelector("p.message2"),a=getCancelThis(),l=getStepAll();o.innerHTML="Confirm Group Update:<br>",o.appendChild(l),o.appendChild(a)})}),Array.from(document.querySelectorAll(".cancelRun, .deadRun, .declined")).forEach(t=>{t.addEventListener("click",t=>{let r=["cancelRun","deadRun","declined"],n=e.getClosest(t.target,".page");Array.from(n.querySelectorAll(".cancelThis")).forEach(t=>{e.triggerEvent(t,"click")});let o=e.getClosest(t.target,".tickets");Array.from(o.querySelectorAll("button")).forEach(e=>{e.disabled=!0});let a,l=o.querySelector(".message2"),i=getCancelThis(),c=o.querySelector(".dTicket").getAttribute("form");if(1===t.target.classList.length)a=getCancelTicket(c,ucfirst(t.target.getAttribute("class")));else for(let e=0;e<t.target.classList.length;e++)if(r.indexOf(-1!==t.target.classList[e])){a=getCancelTicket(c,ucfirst(t.target.classList[e]));break}l.innerHTML="Confirm "+t.target.innerText+":<br>",l.appendChild(a),l.appendChild(i)})}),Array.from(document.querySelectorAll(".transferTicket")).forEach(t=>{t.addEventListener("click",t=>{let r=e.getClosest(t.target,".page");Array.from(r.querySelectorAll(".cancelThis")).forEach(t=>{e.triggerEvent(t,"click")});let n=e.getClosest(t.target,".tickets");Array.from(n.querySelectorAll("button")).forEach(e=>{e.disabled=!0});let o=n.querySelector(".message2"),a=getCancelThis(),l=getTransferTicket(t.target.getAttribute("form"));o.innerHTML="Confirm "+t.target.innerText+":<br>",o.appendChild(l);let i=document.createElement("input");i.setAttribute("name","pendingReceiver"),i.setAttribute("list","receivers"),i.classList.add("pendingReceiver"),o.appendChild(i),o.appendChild(a)})}),Array.from(document.querySelectorAll(".transferGroup")).forEach(t=>{t.addEventListener("click",t=>{t.preventDefault();let r=e.getClosest(t.target,".page");Array.from(r.querySelectorAll(".cancelThis")).forEach(t=>{e.triggerEvent(t,"click")});let n=e.getClosest(t.target,".sortable");Array.from(n.querySelectorAll("button")).forEach(e=>{e.disabled=!0});let o=n.querySelector("p.message2"),a=getCancelThis(),l=getTransferGroup();o.innerHTML="Confirm Transfer:<br>";let i=document.createElement("input");i.setAttribute("name","pendingReceiver"),i.setAttribute("list","receivers"),i.classList.add("pendingReceiver"),o.appendChild(l),o.appendChild(i),o.appendChild(a)})}),Array.from(document.querySelectorAll(".cancelTransfer, .declineTransfer, .acceptTransfer")).forEach(t=>{t.addEventListener("click",t=>{t.preventDefault();let r=["cancelTransfer","declineTransfer","acceptTransfer"],n=e.getClosest(t.target,".page");Array.from(n.querySelectorAll(".cancelThis")).forEach(t=>{e.triggerEvent(t,"click")});let o=e.getClosest(t.target,".tickets");Array.from(o.querySelectorAll("button")).forEach(e=>{e.disabled=!0});let a,l=o.querySelector(".message2"),i=getCancelThis();if(1===t.target.classList.length)a=getTransferButton(t.target.getAttribute("class"));else for(let e=0;e<t.target.classList.length;e++)if(r.indexOf(-1!==t.target.classList[e])){a=getTransferButton(t.target.classList[e]);break}l.innerHTML="Confirm "+t.target.innerText+":<br>",l.appendChild(a),l.appendChild(i)})}),Array.from(document.querySelectorAll(".acceptTransferGroup, .declineTransferGroup, .cancelTransferGroup")).forEach(t=>{t.addEventListener("click",t=>{t.preventDefault();let r=["acceptTransferGroup","declineTransferGroup","cancelTransferGroup"],n=e.getClosest(t.target,".page");Array.from(n.querySelectorAll(".cancelThis")).forEach(t=>{e.triggerEvent(t,"click")});let o=e.getClosest(t.target,".sortable");Array.from(o.querySelectorAll("button")).forEach(e=>{e.disabled=!0});let a,l=o.querySelector("p.message2"),i=getCancelThis();if(1===t.target.classList.length)a=getTransferAllButton(ucfirst(t.target.getAttribute("class")));else{for(let e=0;e<t.target.classList.length;e++)if(r.indexOf(-1!==t.target.classList[e])){a=getTransferAllButton(ucfirst(t.target.classList[e]));break}}l.innerHTML="Confirm "+t.target.innerText+":<br>",l.appendChild(a),l.appendChild(i)})}),document.querySelector("#ticketEditorSubmit")&&(document.querySelector("#ticketEditorSubmit").addEventListener("click",async t=>{t.preventDefault();let r=document.querySelector("#ticketEditorResultContainer"),n={},o=document.querySelector("#ticketEditor");if(n.dispatchedTo=o.querySelector(".driverID").value,n.contract=o.querySelector(".contract").value,n.ticketEditorSearchDate=o.querySelector(".ticketEditorSearchDate").value,n.formKey=document.querySelector("#formKey").value,!n.dispatchedTo||!n.ticketEditorSearchDate)return!1;let a=document.createElement("span");a.classList.add("ellipsis"),a.innerHTML=".",r.innerHTML="",r.appendChild(a);let l=!0,i=setInterval(()=>{!0===l&&(a.innerHTML+="..",l=a.innerHTML.length<21&&1!=a.innerHTML.length),!1===l&&(a.innerHTML=a.innerHTML.substr(0,a.innerHTML.length-2),l=1===a.innerHTML.length)},500);await e.fetch_template({url:"./activeTickets.php",postData:n}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(clearInterval(i),r.innerHTML=-1===t.indexOf("Session Error")?"":'<p class="center">Select Driver &amp; Ticket Type</p>',-1!==t.indexOf("Session Error"))return e.showLogin();document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,r.innerHTML=t,assignTicketEditorListener()}).catch(e=>{console.error(e.message),clearInterval(i);let t=document.createElement("p");t.classList.add("center"),r.innerHTML="",r.appendChild(t),t.innerHTML='<span class="error">Error</span>: '+e.message,setTimeout(()=>{t.innerHTML="Select Driver &amp; Ticket Type"},3500)})}),document.querySelector("#clearTicketEditorResults").addEventListener("click",e=>{e.preventDefault();let t=document.querySelector("#ticketEditor"),r=new Date,n=r.getDate()<10?`0${r.getDate()}`:r.getDate(),o=r.getMonth()+1,a=o<10?`0${o}`:o;t.querySelector(".driverID").value="",t.querySelector(".contract").value=0,t.querySelector(".ticketEditorSearchDate").value=`${r.getFullYear()}-${a}-${n}`,document.querySelector("#ticketEditorResultContainer").innerHTML='<p class="center">Select Driver &amp; Ticket Type</p>'})),document.querySelector("form#priceCalc")){let t=document.querySelector("form#priceCalc");t.querySelector(".dryIce").addEventListener("change",t=>{let r=e.getClosest(t.target,"td");t.target.checked?(r.querySelector(".diWeight").value="0",r.querySelector(".diWeight").disabled=!1,r.querySelector(".diWeight").focus()):(r.querySelector(".diWeight").value="0",r.querySelector(".diWeight").disabled=!0)}),Array.from(t.querySelectorAll("input[list]")).forEach(t=>{"Address1"===t.getAttribute("name").substr(1)&&t.addEventListener("blur",t=>{let r;Array.from(document.querySelectorAll("#addy1 option")).forEach(e=>{e.value===t.target.value&&(r=e.getAttribute("data-value"))}),void 0!==r&&Array.from(document.querySelectorAll("#addy2 option")).forEach(n=>{n.getAttribute("data-value")===r&&(e.getClosest(t.target,"fieldset").querySelector("input[name='"+t.target.getAttribute("name").slice(0,-1)+"2']").value=n.value)})})}),t.querySelector(".clear").addEventListener("click",r=>{t.querySelector(".dryIce").checked=!1,e.triggerEvent(t.querySelector(".dryIce"),"change"),document.querySelector("#CalcCharge").value="0",Array.from(document.querySelectorAll("#pNotice, #dNotice, #rangeResult, #diWeightResult, #diPriceResult, #runPriceResult, #ticketPriceResult")).forEach(e=>{e.innerText=""}),Array.from(document.querySelectorAll("#priceResult .currencySymbol, #priceResult .weightMarker")).forEach(e=>{e.style.display="none"}),Array.from(document.querySelectorAll("#price_calculator .elementError")).forEach(e=>e.classList.remove("elementError")),e.updateMap({mapDivID:"map2"})}),t.querySelector(".submitPriceQuery").addEventListener("click",async r=>{r.preventDefault(),Array.from(t.querySelectorAll("button")).forEach(e=>{e.disabled=!0});let n=!1,o={},a=document.createElement("span");a.classList.add("ellipsis"),a.innerHTML=".",t.querySelector(".ticketError").innerHTML="",t.querySelector(".ticketError").appendChild(a);let l=!0,i=setInterval(()=>{!0===l&&(a.innerHTML+="..",l=a.innerHTML.length<21&&1!=a.innerHTML.length),!1===l&&(a.innerHTML=a.innerHTML.substr(0,a.innerHTML.length-2),l=1===a.innerHTML.length)},500);if(o.formKey=document.querySelector("#formKey").value,Array.from(t.querySelectorAll("input[name]")).forEach(e=>{e.getAttribute("list")&&!1===e.disabled&&""===e.value?(n=!0,e.classList.add("elementError"),setTimeout(()=>{e.classList.remove("elementError")},3500)):!1===e.disabled&&"checkbox"!==e.type&&(o[e.getAttribute("name")]=e.value),"checkbox"===e.type&&(o[e.getAttribute("name")]=e.checked?1:0)}),1===o.dryIce&&("0"!==o.diWeight&&o.diWeight%t.querySelector(".diWeight").getAttribute("step")==0||(n=!0,t.querySelector(".diWeight").classList.add("elementError"),t.querySelector(".ticketError").innerHTML="Dry Ice must be in increments of "+t.querySelector(".diWeight").getAttribute("step"))),n)return clearInterval(i),setTimeout(()=>{Array.from(t.querySelectorAll("button, .elementError")).forEach(e=>{e.disabled=!1,e.classList.remove("elementError")}),t.querySelector(".ticketError").innerHTML=""},3500),!1;await e.fetch_template({url:"../priceCalc.php",postData:o}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(r=>{if(clearInterval(i),t.querySelector(".ticketError").innerHTML="",-1!==r.indexOf("Session Error"))return e.showLogin();let n;document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,Array.from(document.querySelectorAll("#pNotice, #dNotice, #CalcError")).forEach(e=>{e.innerHTML=""});try{n=JSON.parse(r)}catch(e){return document.querySelector("#CalcError").innerHTML=e.message,setTimeout(()=>{document.querySelector("#CalcError").innerText=""},3500),!1}Array.from(document.querySelectorAll("#priceResult .currencySymbol, #priceResult .weightMarker")).forEach(e=>{e.classList.remove("hide")}),document.querySelector("#rangeResult").innerText=n.rangeDisplay,document.querySelector("#diWeightResult").innerText=n.diWeight,document.querySelector("#runPriceResult").innerText=n.runPrice,document.querySelector("#diPriceResult").innerText=n.diPrice,document.querySelector("#ticketPriceResult").innerText=n.ticketPrice,n.pRangeTest>15&&n.pRangeTest<20?document.querySelector("#pNotice").innerText="Pick Up address is outside of our standard range. Please call to confirm availability.":n.pRangeTest>20&&(document.querySelector("#pNotice").innerText="Pick Up address is outside of our extended range.",Array.from(document.querySelectorAll("#runPriceResult, #ticketPriceResult, #diPriceResult, #diWeightResult")).forEach(e=>{e.innerText=""}),Array.from(document.querySelectorAll("#priceResult .currencySymbol, #priceResult .weightMarker")).forEach(e=>{e.classList.add("hide")})),n.dRangeTest>15&&n.dRangeTest<20?document.querySelector("#dNotice").innerText="Delivery address is outside of our standard range. Please call to confirm availability.":n.dRangeTest>20&&(document.querySelector("#dNotice").innerText="Delivery address is outside of our extended range.",Array.from(document.querySelectorAll("#runPriceResult, #ticketPriceResult, #diPriceResult, #diWeightResult")).forEach(e=>{e.innerText=""}),Array.from(document.querySelectorAll("#priceResult .currencySymbol, #priceResult .weightMarker")).forEach(e=>{e.classList.add("hide")})),Array.from(t.querySelectorAll("button")).forEach(e=>{e.disabled=!1}),e.updateMap({mapDivID:"map2",coords1:n.result1,address1:n.address1,coords2:n.result2,address2:n.address2,center:n.center})}).catch(e=>{console.error(e.message),clearInterval(i),t.querySelector(".ticketError").innerHTML='<span class="error">Error</span>: '+e.message,setTimeout(()=>{t.querySelector(".ticketError").innerHTML="",Array.from(t.querySelectorAll("button")).forEach(e=>{e.disabled=!1})},3500)})})}document.querySelector(".PWcontainer")&&(document.querySelector(".PWcontainer .showText").addEventListener("change",t=>{Array.from(e.getClosest(t.target,"form").querySelectorAll("input.currentPw, .newPw1, .newPw2")).forEach(e=>{e.type=t.target.checked?"text":"password"})}),document.querySelector(".clearPWform").addEventListener("click",t=>{e.getClosest(t.target,"form").querySelector(".showText").checked=!1,e.triggerEvent(e.getClosest(t.target,"form").querySelector(".showText"),"change")}),Array.from(document.querySelectorAll(".newPw1, .newPw2, .currentPw")).forEach(t=>{t.addEventListener("change",t=>{let r=e.getClosest(t.target,".PWform"),n=r.querySelector(".PWsubmit"),o=r.querySelector(".currentPw").value,a=r.querySelector(".newPw1").value,l=r.querySelector(".newPw2").value,i=document.createElement("p"),c=document.createElement("p"),s=document.createElement("p");if(i.classList.add("error1"),i.innerHTML='<span class="error">Error</span>: Password does not meet criteria.',c.classList.add("error2"),c.innerHTML='<span class="error">Error</span>: Password missmatch.',s.classList.add("error3"),s.innerHTML='<span class="error">Error:</span> Password should be changed.',""!==a){if(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^\&*\)\(\{\}\[\]\-_.=+\?\:;,])(?=.{8,}).*$/.test(a))null!==r.querySelector(".message .error1")&&r.querySelector(".message").removeChild(r.querySelector(".message .error1")),null===r.querySelector(".message p")&&(n.disabled=!1);else if(null!==r.querySelector(".message .error1"))return r.querySelector(".message").appendChild(i),n.disabled=!0,!1;""!==o&&a===o?null===r.querySelector(".message .error3")&&(r.querySelector(".message").appendChild(s),n.disabled=!0):(null!==r.querySelector(".message .error3")&&r.querySelector(".message").removeChild(r.querySelector(".message .error3")),null===r.querySelector(".message p")&&(n.disabled=!1))}else null!==r.querySelector(".message .error1")&&r.querySelector(".message").removeChild(r.querySelector(".message .error1")),null===r.querySelector(".message p")&&(n.disabled=!1);""!==l&&a!==l?(null===r.querySelector(".message .error2")&&r.querySelector(".message").appendChild(c),n.disabled=!0):(null!==r.querySelector(".message .error2")&&r.querySelector(".message").removeChild(r.querySelector(".message .error2")),null===r.querySelector(".message p")&&(n.disabled=!1))})}),Array.from(document.querySelectorAll(".PWsubmit")).forEach(t=>{t.addEventListener("click",async t=>{t.preventDefault(),t.target.disabled=!0;let r=e.getClosest(t.target,".PWform"),n={},o=document.createElement("span");o.classList.add("ellipsis"),o.innerHTML=".",r.querySelector(".message").innerHTML="",r.querySelector(".message").appendChild(o);let a=!0,l=setInterval(()=>{!0===a&&(o.innerHTML+="..",a=o.innerHTML.length<21&&1!=o.innerHTML.length),!1===a&&(o.innerHTML=o.innerHTML.substr(0,o.innerHTML.length-2),a=1===o.innerHTML.length)},500);n.formKey=document.querySelector("#formKey").value,Array.from(r.querySelectorAll("input[name]")).forEach(e=>{n[e.getAttribute("name")]=e.value}),await e.fetch_template({url:"./changePW.php",postData:n}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(o=>{if(clearInterval(l),-1!==o.indexOf("Session Error"))return e.showLogin();document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,r.querySelector(".message").innerHTML=o,setTimeout(()=>{if(Array.from(r.querySelectorAll(".currentPw, .newPw1, .newPw2")).forEach(e=>{e.value=""}),r.querySelector(".message").innerHTML="",r.querySelector(".currentPw").focus(),t.target.disabled=!1,"driver"!==n.flag&&"dispatch"!==n.flag){let r,a=e.getClosest(t.target,".page"),l=!1;switch(n.flag){case"daily":r=document.querySelector("a[data-id='change_password']"),l="!Delivery1"===n.newPw1;break;case"admin":r=document.querySelector("a[data-id='change_admin_password']"),l="!Delivery2"===n.newPw1;break;case"org":r=document.querySelector("a[data-id='change_password']"),l="3Delivery!"===n.newPw1}-1!==o.search("Password Updated")&&(!0===l?(a.querySelector(".defaultWarning").classList.remove("hide"),r.querySelector(".PWalert").innerText="!"):(a.querySelector(".defaultWarning").classList.contains("hide")||a.querySelector(".defaultWarning").classList.add("hide"),r.querySelector(".PWalert").innerText=""))}},4e3)}).catch(e=>{console.error(e.message),clearInterval(l),r.querySelector(".message").innerHTML='<span class="error">Error</span>: '+e.message,setTimeout(()=>{r.querySelector(".message").innerHTML="",t.target.disabled=!1},3500)})})})),document.querySelector("#invoiceQueryOptions")&&(document.querySelector("#useInvoice")&&document.querySelector("#useInvoice").addEventListener("change",t=>{document.querySelector("#invoiceNumber").disabled=!1===t.target.checked,e.getClosest(t.target,"#singleInvoiceQuery").querySelector(".dateIssuedMonth").disabled=!0===t.target.checked,e.getClosest(t.target,"#singleInvoiceQuery").querySelector(".dateIssuedMonth").required=!1===t.target.checked}),Array.from(document.querySelectorAll("#single, #multi")).forEach(e=>{e.addEventListener("click",e=>{e.target.checked||e.preventDefault()}),e.addEventListener("change",e=>{let t=[];Array.from(document.querySelectorAll("#invoiceQueryOptions .orgMember")).forEach(r=>{r.checked&&t.push(r),r.checked=!1,r.setAttribute("form",e.target.getAttribute("form"))});let r="single"===e.target.getAttribute("id")?"multi":"single",n=document.querySelector("#"+r).getAttribute("form");"single"===r&&(document.querySelector("#compareMembers").disabled=!0),e.target.checked&&(document.querySelector("#"+r).checked=!1),t.length>0&&(t[0].checked=!0),document.querySelector("button[form='"+e.target.getAttribute("form")+"']").disabled=!1,document.querySelector("button[form='"+n+"']").disabled=!0})}),Array.from(document.querySelectorAll("#invoiceQueryOptions .orgMember")).forEach(e=>{e.addEventListener("change",e=>{let t=0;Array.from(document.querySelectorAll("#invoiceQueryOptions .orgMember")).forEach(r=>{document.querySelector("#single").checked?r.checked=r===e.target:t+=r.checked}),document.querySelector("#compareMembers").disabled=t<2})}),document.querySelector("#single")&&e.triggerEvent(document.querySelector("#single"),"change"),Array.from(document.querySelectorAll("#singleInvoice, #rangeInvoice")).forEach(t=>{t.addEventListener("click",async t=>{t.preventDefault(),t.target.disabled=!0;let r=!1,n={},o=document.createElement("span"),a=document.createElement("p");a.classList.add("center"),o.innerHTML=".",a.appendChild(o),document.querySelector("#invoiceQueryResults").innerHTML="",document.querySelector("#invoiceQueryResults").appendChild(a);let l=!0,i=setInterval(()=>{!0===l&&(o.innerHTML+="..",l=o.innerHTML.length<21&&1!=o.innerHTML.length),!1===l&&(o.innerHTML=o.innerHTML.substr(0,o.innerHTML.length-2),l=1===o.innerHTML.length)},500);if(Array.from(document.querySelectorAll("input[form='"+t.target.getAttribute("form")+"'], select[form='"+t.target.getAttribute("form")+"']")).forEach(e=>{e.required&&""===e.value&&(r=!0,e.classList.add("elementError"),setTimeout(()=>{e.classList.remove("elementError")},3e3)),"[]"===e.getAttribute("name").slice(-2)?void 0===n[e.getAttribute("name").slice(0,-2)]?"checkbox"===e.type?!0===e.checked&&!1===e.disabled&&(n[e.getAttribute("name").slice(0,-2)]=[e.value]):!1===e.disabled&&(n[e.getAttribute("name").slice(0,-2)]=[e.value]):"checkbox"===e.type?!0===e.checked&&!1===e.disabled&&n[e.getAttribute("name").slice(0,-2)].push(e.value):!1===e.disabled&&n[e.getAttribute("name").slice(0,-2)].push(e.value):"checkbox"===e.type?!0===e.checked&&!1===e.disabled&&(n[e.getAttribute("name")]=e.value):!1===e.disabled&&(n[e.getAttribute("name")]=e.value)}),r)return clearInterval(i),document.querySelector("#invoiceQueryResults").removeChild(a),t.target.disabled=!1,!1;n.formKey=document.querySelector("#formKey").value,await e.fetch_template({url:"./buildQuery.php",postData:n}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(r=>{if(clearInterval(i),document.querySelector("#invoiceQueryResults").removeChild(a),-1!==r.indexOf("Session Error"))return e.showLogin();document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1;let n=(new DOMParser).parseFromString(r,"text/html"),o=document.createDocumentFragment();Array.from(n.querySelectorAll("#invoiceChartPDFform, .bargraph, .graphKey, #invoice, .invoiceTable, p.displayHeader, .result")).forEach(e=>{o.appendChild(e)}),document.querySelector("#invoiceQueryResults").appendChild(o),t.target.disabled=!1,assignQueriedInvoiceListeners()}).catch(e=>{console.error(e.message),clearInterval(i),document.querySelector("#invoiceQueryResults").innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>",setTimeout(()=>{document.querySelector("#invoiceQueryResults").innerHTML="",t.target.disabled=!1},3500)})})})),document.querySelector("#deliveryQuery")&&(Array.from(document.querySelectorAll("#deliveryQuery .orgMember")).forEach(t=>{t.addEventListener("change",t=>{e.disableButtonsTickets(),t.target.checked?(document.querySelector("#ticketNumber").value="",document.querySelector("#ticketNumber").readOnly=!0,e.triggerEvent(document.querySelector("#ticketNumber"),"change")):document.querySelector("#ticketNumber").readOnly="chart"===document.querySelector("#display").value})}),document.querySelector("#display")&&document.querySelector("#display").addEventListener("change",e=>{document.querySelector("#compareBox")&&Array.from(document.querySelectorAll("#compareBox, #compareMembersTickets")).forEach(t=>{t.disabled="tickets"===e.target.value,"tickets"===e.target.value&&(t.checked=!1)}),document.querySelector("#ticketNumber").disabled="chart"===e.target.value||"tickets"===e.target.value&&!0===document.querySelector("#allTime").checked,Array.from(document.querySelectorAll("#chargeHistory, #type")).forEach(t=>{t.disabled="chart"===e.target.value}),Array.from(document.querySelectorAll("#deliveryQuery .ticketDate, #deliveryQuery .chartDate")).forEach(t=>{"tickets"===e.target.value?(t.style.display=t.classList.contains("ticketDate")?"inline":"none",t.querySelector("input")&&(t.querySelector("input").disabled="month"===t.querySelector("input").getAttribute("type"),t.querySelector("input").value="",!1===t.querySelector("input").disabled&&(t.querySelector("input").disabled=document.querySelector("#allTime").checked))):(t.style.display=t.classList.contains("ticketDate")?"none":"inline",t.querySelector("input")&&(t.querySelector("input").disabled="month"!==t.querySelector("input").getAttribute("type"),t.querySelector("input").value="",!1===t.querySelector("input").disabled&&(t.querySelector("input").disabled=document.querySelector("#allTime").checked)))})}),document.querySelector("#allTime").addEventListener("change",t=>{let r=document.querySelector("#display")&&"chart"===document.querySelector("#display").value?".chartDate":".ticketDate";!0===t.target.checked?Array.from(e.getClosest(t.target,"form").querySelectorAll("input[name='startDate'], input[name='endDate'], #ticketNumber")).forEach(e=>{e.value="",e.disabled=!0}):(Array.from(e.getClosest(t.target,"form").querySelectorAll(r+" input[name='startDate'], "+r+" input[name='endDate']")).forEach(e=>{e.disabled=!1}),document.querySelector("#display")?document.querySelector("#ticketNumber").disabled="chart"===document.querySelector("#display").value:document.querySelector("#ticketNumber").disabled=!1)}),document.querySelector("#ticketNumber").addEventListener("blur",t=>{""!==t.target.value?(document.querySelector("#display")&&(document.querySelector("#display").value="tickets",e.triggerEvent(document.querySelector("#display"),"change")),Array.from(document.querySelectorAll("#deliveryQuery .startDateDate, #deliveryQuery .endDateDate, #chargeHistory, #charge, #type, #allTime, #display, #compareBox, #compareMembersTickets, #deliveryQuery .orgMember")).forEach(e=>{e.disabled=!0,e.checked=!1,e.required=!1}),Array.from(document.querySelectorAll("#deliveryQuery .startDateMarker, #deliveryQuery .endDateMarker, #deliveryQuery .chargeMarker, #deliveryQuery .typeMarker, #displayMarker")).forEach(e=>{e.disabled=!1})):(Array.from(document.querySelectorAll("#deliveryQuery .startDateDate, #deliveryQuery .endDateDate, #chargeHistory, #charge, #type, #allTime, #display, #compareBox, #compareMembersTickets, #deliveryQuery .orgMember")).forEach(e=>{e.disabled=!1,e.required=e.classList.contains("startDate")||e.classList.contains("endDate")}),Array.from(document.querySelectorAll("#deliveryQuery .startDateMarker, #deliveryQuery .endDateMarker, #deliveryQuery .chargeMarker, #deliveryQuery .typeMarker, #displayMarker")).forEach(e=>{e.disabled=!0}))}),document.querySelector(".submitOrgTickets")?document.querySelector(".submitOrgTickets").addEventListener("click",async t=>{t.preventDefault();let r={},n=document.createElement("span"),o=document.createElement("p");r.formKey=document.querySelector("#formKey").value,o.classList.add("center"),n.innerHTML=".",o.appendChild(n),document.querySelector("#ticketQueryResults").appendChild(o);let a=!0,l=setInterval(()=>{!0===a&&(n.innerHTML+="..",a=n.innerHTML.length<21&&1!=n.innerHTML.length),!1===a&&(n.innerHTML=n.innerHTML.substr(0,n.innerHTML.length-2),a=1===n.innerHTML.length)},500);Array.from(document.querySelectorAll("#deliveryQuery input, #deliveryQuery select")).forEach(e=>{e.disabled||e.readOnly||("[]"===e.getAttribute("name").slice(-2)?("checkbox"===e.getAttribute("type")&&e.checked||"checkbox"!==e.getAttribute("type")&&""!==e.value)&&(void 0===r[e.getAttribute("name").slice(0,e.getAttribute("name").length-2)]?r[e.getAttribute("name").slice(0,e.getAttribute("name").length-2)]=[e.value]:"object"!=typeof r[e.getAttribute("name").slice(0,e.getAttribute("name").length-2)]&&"array"!=typeof r[e.getAttribute("name").slice(0,e.getAttribute("name").length-2)]||r[e.getAttribute("name").slice(0,e.getAttribute("name").length-2)].push(e.value)):"checkbox"===e.getAttribute("type")?e.checked&&(r[e.getAttribute("name")]=e.value):r[e.getAttribute("name")]=e.value)}),await e.fetch_template({url:"./buildQuery.php",postData:r}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(r=>{if(t.target.disabled=!1,clearInterval(l),-1!==r.indexOf("Session Error"))return e.showLogin();document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1;let n=(new DOMParser).parseFromString(r,"text/html"),o=document.createDocumentFragment();Array.from(n.querySelectorAll("#ticketPDFform, .tickets, .ticketTable, .bargraph, .graphKey, .result")).forEach(e=>{o.appendChild(e)}),document.querySelector("#ticketQueryResults").innerHTML="",document.querySelector("#ticketQueryResults").appendChild(o),e.assignQueriedTicketListeners()}).catch(e=>{console.error(e.message),t.target.disabled=!1,clearInterval(l),document.querySelector("#ticketQueryResults").innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>",setTimeout(()=>{document.querySelector("#ticketQueryResults").innerHTML=""},3500)})}):(document.querySelector(".clearTicketResults").addEventListener("click",e=>{document.querySelector("#ticketQueryResults").innerHTML=""}),document.querySelector(".resetTicketQuery").addEventListener("click",t=>{document.querySelector("#display").value="tickets",e.triggerEvent(document.querySelector("#display"),"change"),Array.from(document.querySelectorAll("#deliveryQuery .elementError")).forEach(e=>{e.classList.remove("elementError")})}),document.querySelector(".submitTicketQuery").addEventListener("click",async t=>{t.preventDefault(),t.target.disabled=!0;let r=!1,n={},o=document.createElement("span"),a=document.createElement("p");if(a.classList.add("center"),o.innerHTML=".",a.appendChild(o),Array.from(document.querySelectorAll("#deliveryQuery input, #deliveryQuery select")).forEach(e=>{e.disabled||("checkbox"!==e.type?e.value&&(n[e.getAttribute("name")]=e.value):n[e.getAttribute("name")]=e.checked?1:0)}),n.hasOwnProperty("ticketNumber")||n.allTime?n.ticketNumber||n.allTime||(r=!0,document.querySelector("#ticketNumber").classList.add("elementError"),setTimeout(()=>{document.querySelector("#ticketNumber").classList.remove("elementError")},3500)):n.hasOwnProperty("startDate")&&n.startDate&&n.hasOwnProperty("endDate")&&n.endDate||(r=!0,Array.from(document.querySelectorAll("#deliveryQuery input[name='startDate'], #deliveryQuery input[name='endDate']")).forEach(e=>{e.value||(e.classList.add("elementError"),setTimeout(()=>{e.classList.remove("elementError")},3500))})),n.formKey=document.querySelector("#formKey").value,r)return t.target.disabled=!1,!1;document.querySelector("#ticketQueryResults").appendChild(a);let l=!0,i=setInterval(()=>{!0===l&&(o.innerHTML+="..",l=o.innerHTML.length<21&&1!=o.innerHTML.length),!1===l&&(o.innerHTML=o.innerHTML.substr(0,o.innerHTML.length-2),l=1===o.innerHTML.length)},500);await e.fetch_template({url:"./buildQuery.php",postData:n}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(r=>{if(t.target.disabled=!1,clearInterval(i),-1!==r.indexOf("Session Error"))return e.showLogin();document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1;let n=(new DOMParser).parseFromString(r,"text/html"),o=document.createDocumentFragment();Array.from(n.querySelectorAll("#ticketPDFform, .bargraph, .graphKey, .tickets, .ticketTable, .ticketGraphContainer, .result")).forEach(e=>{o.appendChild(e)}),document.querySelector("#ticketQueryResults").innerHTML="",document.querySelector("#ticketQueryResults").appendChild(o),e.assignQueriedTicketListeners()}).catch(e=>{console.error(e.message),t.target.disabled=!1,clearInterval(i),document.querySelector("#ticketQueryResults").innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>",setTimeout(()=>{document.querySelector("#ticketQueryResults").innerHTML=""},3500)})}))),document.querySelector("#clientUpdateForm")&&(document.querySelector("#same").addEventListener("change",t=>{Array.from(document.querySelectorAll("input[name='BillingName'], input[name='BillingAddress1'], input[name='BillingAddress2'], input[name='BillingCountry']")).forEach(e=>{e.disabled=!0===t.target.checked,e.required=!1===t.target.checked}),Array.from(document.querySelectorAll("fieldset[name='billingInfo'] .error")).forEach(e=>{e.style.display=!0===t.target.checked?"none":"inline"}),e.getClosest(document.querySelector("input[name='BillingCountry'][form='clientUpdate']"),"tr").classList.contains("hide")&&(document.querySelector("input[name='BillingCountry'][form='clientUpdate']").value=document.querySelector("input[name='ShippingCountry'][form='clientUpdate']").value)}),document.querySelector("#enableInfoUpdate").addEventListener("change",e=>{document.querySelector("#submitInfoUpdate").disabled=!1===e.target.checked}),document.querySelector("#submitInfoUpdate").addEventListener("click",async t=>{t.preventDefault(),t.target.disabled=!0;let r={},n=!1,o=document.createElement("span");o.classList.add("ellipsis"),o.innerHTML=".",document.querySelector("#clientUpdateResult").appendChild(o);let a=!0,l=setInterval(()=>{!0===a&&(o.innerHTML+=".",a=o.innerHTML.length<21&&1!=o.innerHTML.length),!1===a&&(o.innerHTML=o.innerHTML.substr(0,o.innerHTML.length-2),a=1===o.innerHTML.length)},500);if(Array.from(document.querySelectorAll("input[form='"+t.target.getAttribute("form")+"']")).forEach(e=>{!0===e.required&&""===e.value&&(console.log(e),n=!0,e.classList.add("elementError"),setTimeout(()=>{e.classList.remove("elementError")},3e3)),!1===e.disabled&&(r[e.getAttribute("name")]=e.value),"checkbox"===e.type&&(r[e.getAttribute("name")]=!0===e.checked?1:0)}),!0===n)return clearInterval(l),t.target.disabled=!1,document.querySelector("#clientUpdateResult").removeChild(o),!1;r.formKey=document.querySelector("#formKey").value,await e.fetch_template({url:"./updateClientInfo.php",postData:r}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(r=>{if(t.target.disabled=!1,clearInterval(l),-1!==r.indexOf("Session Error"))return e.showLogin();document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1;let n=(new DOMParser).parseFromString(r,"text/html"),o=document.createDocumentFragment();Array.from(n.querySelectorAll(".result")).forEach(e=>{o.appendChild(e)}),document.querySelector("#clientUpdateResult").innerHTML="",document.querySelector("#clientUpdateResult").appendChild(o),setTimeout(()=>{document.querySelector("#clientUpdateResult").innerHTML="",document.querySelector("#enableInfoUpdate").checked=!1,e.triggerEvent(document.querySelector("#enableInfoUpdate"),"change")},3500)}).catch(e=>{console.error(e.message),t.target.disabled=!1,clearInterval(l),document.querySelector("#clientUpdateResult").innerHTML='<span class="error">Error</span>: '+e.message,setTimeout(()=>{document.querySelector("#clientUpdateResult").innerHTML=""},3500)})}))}),assignQueriedInvoiceListeners=(()=>{document.querySelector("#invoicePDF")&&document.querySelector("#invoicePDF").addEventListener("click",e=>{e.preventDefault();let t,r=document.querySelector("#invoice").cloneNode(!0),n={},o=["position","top","left","right","font-size"];if(null!==document.querySelector("#invoice .vatNotice")){t=getComputedStyle(document.querySelector("#invoice .vatNotice"));for(let e in t)-1!==o.indexOf(e)&&(n[e]=t.getPropertyValue(e))}r.querySelector("#invoicePDFform").remove(),Array.from(r.querySelectorAll(".vatNotice")).forEach(e=>{e.parentNode.style.position="relative";for(let t in n)e.style[t]=n[t]}),document.querySelector("#invoicePDFform input[name='content']").value=r.outerHTML,document.querySelector("#invoicePDFform input[name='formKey']").value=document.querySelector("#formKey").value,document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,document.querySelector("#invoicePDFform").submit()}),document.querySelector("#invoiceChartPDF")&&document.querySelector("#invoiceChartPDF").addEventListener("click",t=>{t.preventDefault();let r=document.querySelector("#invoiceQueryResults").cloneNode(!0);r.querySelector("#invoiceChartPDFform").remove(),Array.from(r.querySelectorAll(".invoiceQuery")).forEach(t=>{let r=e.getClosest(t,"td"),n=t.innerHTML,o=Array.from(t.classList);r.classList.add(...o),r.innerHTML=n}),document.querySelector("#invoiceChartPDFform input[name='content']").value=r.outerHTML,document.querySelector("#invoiceChartPDFform input[name='formKey']").value=document.querySelector("#formKey").value,document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,document.querySelector("#invoiceChartPDFform").submit()}),Array.from(document.querySelectorAll("#invoiceQueryResults .invoiceQuery")).forEach(t=>{t.addEventListener("click",async t=>{t.preventDefault(),t.target.classList.add("red"),t.target.disabled=!0,setTimeout(()=>{t.target.classList.remove("red")},3500);let r={},n=document.createElement("p");n.classList.add("center"),n.innerHTML=".",e.getClosest(t.target,".invoiceTable").appendChild(n);let o=!0,a=setInterval(()=>{!0===o&&(n.innerHTML+="..",o=n.innerHTML.length<21&&1!=n.innerHTML.length),!1===o&&(n.innerHTML=n.innerHTML.substr(0,n.innerHTML.length-2),o=1===n.innerHTML.length)},500);Array.from(e.getClosest(t.target,"form").querySelectorAll("input")).forEach(e=>{r[e.getAttribute("name")]=e.value}),r.formKey=document.querySelector("#formKey").value,await e.fetch_template({url:"./buildQuery.php",postData:r}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(-1!==t.indexOf("Session Error"))return e.showLogin();document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1;let r=(new DOMParser).parseFromString(t,"text/html"),n=document.createDocumentFragment();Array.from(r.querySelectorAll("#invoice, .invoiceTable, .invoiceGraphContainer, p.displayHeader, .result")).forEach(e=>{n.appendChild(e)}),document.querySelector("#invoiceQueryResults").innerHTML="",document.querySelector("#invoiceQueryResults").appendChild(n)}).catch(r=>{console.log(r.message),clearInterval(a),e.getClosest(t.target,".invoiceTable").removeChild(n),errorMessage=document.createElement("p"),errorMessage.classList.add("center"),errorMessage.innerHTML='<span class="error">Error</span>: '+r.message,e.getClosest(t.target,".invoiceTable").appendChild(errorMessage),setTimeout(()=>{e.getClosest(t.target,".invoiceTable").removeChild(errorMessage),t.target.disabled=!1},3500)})})}),document.querySelector("#invoiceQueryResults .invoiceTable")&&(Array.from(document.querySelectorAll("#invoiceQueryResults .invoiceTable, #invoiceQueryResults .invoiceGraphContainer")).forEach(e=>{e.addEventListener("touchstart",e=>{rjdciSwipe.disable()})}),Array.from(document.querySelectorAll("#invoiceQueryResults .invoiceTable, #invoiceQueryResults .invoiceGraphContainer")).forEach(e=>{e.addEventListener("touchend",e=>{rjdciSwipe.enable()})}))}),e.assignQueriedTicketListeners=(()=>{Array.from(document.querySelectorAll("#ticketQueryResults .invoiceQuery")).forEach(t=>{t.addEventListener("click",async t=>{t.preventDefault();let r={};Array.from(e.getClosest(t.target,"form").querySelectorAll("input")).forEach(e=>{r[e.getAttribute("name")]=e.value}),r.formKey=document.querySelector("#formKey").value,document.querySelector("#invoiceQueryResults").innerHTML='<p class="center"><span class="ellipsis">.</span></p>',rjdciSwipe.slide(document.querySelector("a.nav[data-id='invoice_query']").getAttribute("data-value"),300);let n=!0,o=document.querySelector("#invoiceQueryResults .ellipsis"),a=setInterval(()=>{!0===n&&(o.innerHTML+="..",n=o.innerHTML.length<21&&1!=o.innerHTML.length),!1===n&&(o.innerHTML=o.innerHTML.substr(0,o.innerHTML.length-2),n=1===o.innerHTML.length)},500);await e.fetch_template({url:"./buildQuery.php",postData:r}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(clearInterval(a),-1!==t.indexOf("Session Error"))return e.showLogin();document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1;let r=(new DOMParser).parseFromString(t,"text/html"),n=document.createDocumentFragment();Array.from(r.querySelectorAll("#invoice, .result")).forEach(e=>{n.appendChild(e)}),document.querySelector("#invoiceQueryResults").innerHTML="",document.querySelector("#invoiceQueryResults").appendChild(n)}).catch(e=>{console.error(e.message),clearInterval(a),document.querySelector("#invoiceQueryResults").innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>",setTimeout(()=>{document.querySelector("#invoiceQueryResults").innerHTML=""},3500)})})}),Array.from(document.querySelectorAll("#ticketQueryResults .sigPrint td")).forEach(e=>{e.addEventListener("click",e=>{let t=e.target.parentElement.nextElementSibling;t.style.display="none"===t.style.display||""===t.style.display?"block":"none"})}),Array.from(document.querySelectorAll("#ticketQueryResults .submitTicketQuery")).forEach(t=>{t.addEventListener("click",async t=>{t.preventDefault(),t.target.disabled=!0;let r={},n=document.createElement("span"),o=document.createElement("p");o.classList.add("center"),n.innerHTML=".",o.appendChild(n),Array.from(e.getClosest(t.target,"form").querySelectorAll("input")).forEach(e=>{e.value&&(r[e.getAttribute("name")]=e.value)}),r.formKey=document.querySelector("#formKey").value,document.querySelector("#ticketQueryResults").appendChild(o);let a=!0,l=setInterval(()=>{!0===a&&(n.innerHTML+="..",a=n.innerHTML.length<21&&1!=n.innerHTML.length),!1===a&&(n.innerHTML=n.innerHTML.substr(0,n.innerHTML.length-2),a=1===n.innerHTML.length)},500);await e.fetch_template({url:"./buildQuery.php",postData:r}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(r=>{if(t.target.disabled=!1,clearInterval(l),-1!==r.indexOf("Session Error"))return e.showLogin();document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1;let n=(new DOMParser).parseFromString(r,"text/html"),o=document.createDocumentFragment();Array.from(n.querySelectorAll(".tickets, .result")).forEach(e=>{o.appendChild(e)}),document.querySelector("#ticketQueryResults").innerHTML="",document.querySelector("#ticketQueryResults").appendChild(o),e.assignQueriedTicketListeners()}).catch(e=>{console.error(e.message),t.target.disabled=!1,clearInterval(l),document.querySelector("#ticketQueryResults").innerHTML='<p class="center"><span class="error">Error</span>: '+e.message+"</p>",setTimeout(()=>{document.querySelector("#ticketQueryResults").innerHTML=""},3500)})})}),document.querySelector("#ticketPDF")&&document.querySelector("#ticketPDF").addEventListener("click",e=>{e.preventDefault();let t=document.querySelector("#ticketQueryResults").cloneNode(!0);t.querySelector("#ticketPDF").remove(),Array.from(t.querySelectorAll(".submitTicketQuery")).forEach(e=>{e.parentNode.remove()}),document.querySelector("#ticketPDFform input[name='content']").value=t.outerHTML,document.querySelector("#ticketPDFform input[name='formKey']").value=document.querySelector("#formKey").value,document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,document.querySelector("#ticketPDFform").submit()}),document.querySelector("#ticketQueryResults .bargraph")&&(document.querySelector("#ticketQueryResults .bargraph").addEventListener("touchstart",e=>{rjdciSwipe.disable()}),document.querySelector("#ticketQueryResults .bargraph").addEventListener("touchend",e=>{rjdciSwipe.enable()}))}),assignTicketEditorListener=(()=>{Array.from(document.querySelectorAll("#ticketEditorResultContainer button.ticketEditor")).forEach(t=>{t.getAttribute("data-assigned")||(t.setAttribute("data-assigned",1),t.addEventListener("click",async t=>{t.target.classList.add("red"),setTimeout(()=>{t.target.classList.remove("red")},3e3);let r=e.getClosest(t.target,".sortable"),n={};n.ticket_index=t.target.getAttribute("data-index"),n.ticketEditor=1,n.formKey=document.querySelector("#formKey").value,await e.fetch_template({url:"./enterTicket.php",postData:n}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(t=>{if(-1!==t.indexOf("Session Error"))return e.showLogin();document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1;let n=(new DOMParser).parseFromString(t,"text/html"),o=document.createDocumentFragment();Array.from(r.querySelectorAll("table, hr, button.ticketEditor")).forEach(e=>{e.classList.add("hide")}),Array.from(n.querySelectorAll("datalist, div")).forEach(e=>{o.appendChild(e)}),r.appendChild(o),assignTicketFormListeners(r)}).catch(e=>{console.error(e.message);let t=document.createElement("p");t.classList.add("center"),t.innerHTML='<span class="error">Error</span>: '+e.message,r.appendChild(t),setTimeout(()=>{r.removeChild(t)},3500)})}))})}),assignTicketFormListeners=(t=>{t.querySelector(".repeat")&&t.querySelector(".repeat").addEventListener("change",e=>{t.querySelector(".billTo").setAttribute("list",e.target.checked?"t_clients":"clients"),t.querySelector(".billTo").value="",t.querySelector("checkbox.contract")&&(t.querySelector(".contract").disabled=e.target.checked,e.target.checked&&(t.querySelector(".contract").checked=!1))}),t.querySelector(".emailConfirm").addEventListener("change",t=>{let r=e.getClosest(t.target,"form");"0"!==t.target.value?(r.querySelector(".emailAddress").required=!0,r.querySelector(".emailNote")&&r.querySelector(".emailNote").classList.remove("hide")):(r.querySelector(".emailAddress").required=!1,r.querySelector(".emailNote")&&r.querySelector(".emailNote").classList.add("hide"))}),Array.from(t.querySelectorAll(".dryIce")).forEach(t=>{t.addEventListener("change",t=>{let r=e.getClosest(t.target,"fieldset");t.target.checked?(r.querySelector(".diWeight").value="0",r.querySelector(".diWeight").disabled=!1,r.querySelector(".diWeight").focus(),r.querySelector(".diWeightMarker").value="0",r.querySelector(".diWeightMarker").disabled=!0):(r.querySelector(".diWeightMarker").value="0",r.querySelector(".diWeightMarker").disabled=!1,r.querySelector(".diWeight").value="0",r.querySelector(".diWeight").disabled=!0)})}),t.querySelector(".charge").addEventListener("change",r=>{Array.from(t.querySelectorAll(".rtMarker")).forEach(e=>{"6"===r.target.value||"7"===r.target.value?e.style.display="inline":(e.style.display="none",e.checked=!1)}),t.querySelector("input[name='d2TimeStamp']")&&(t.querySelector("input[name='d2TimeStamp']").disabled="6"!==r.target.value&&"7"!==r.target.value),"7"===r.target.value?(t.querySelector(".dedicatedNote").style.display="block",Array.from(t.querySelectorAll("input[id^='pSigReq'], input[id^='dSigReq']")).forEach(t=>{t.checked=!0,e.triggerEvent(t,"change")})):t.querySelector(".dedicatedNote").style.display="none"}),Array.from(t.querySelectorAll("input[type='number']")).forEach(e=>{e.addEventListener("keydown",()=>{"0"===e.value&&(e.value="")})}),Array.from(t.querySelectorAll("input[type='checkbox'][name='pSigReq'], input[type='checkbox'][name='dSigReq']")).forEach(e=>{e.addEventListener("click",e=>{"7"===t.querySelector(".charge").value&&e.preventDefault()})}),Array.from(t.querySelectorAll("input[type='checkbox'][name='pSigReq'], input[type='checkbox'][name='dSigReq'], input[type='checkbox'][name='d2SigReq']")).forEach(e=>{e.addEventListener("change",e=>{let r=t.querySelector("input[type='checkbox'][name='pSigReq']").checked,n=t.querySelector("input[type='checkbox'][name='dSigReq']").checked,o=t.querySelector("input[type='checkbox'][name='d2SigReq']").checked,a=t.querySelector(".sigNote");r||n||o?a.classList.remove("hide"):a.classList.contains("hide")||a.classList.add("hide")})}),Array.from(t.querySelectorAll("input[list]")).forEach(t=>{t.addEventListener("change",t=>{if(e.isTarget(t.target)){let r=[];if(Array.from(document.querySelectorAll("datalist#"+t.target.getAttribute("list")+" option")).forEach(e=>{let t=(new DOMParser).parseFromString(e.innerHTML,"text/html");t.innerHTML=e.innerHTML,r.push(t.documentElement.textContent)}),""!==t.target.value&&-1===r.indexOf(t.target.value)){let r=t.target.getAttribute("placeholder")||"";return t.target.value="",t.target.classList.add("elementError"),t.target.placeholder="Selection Not On File",e.triggerEvent(t.target,"change"),void setTimeout(()=>{t.target.classList.remove("elementError"),t.target.placeholder=r},3e3)}}t.target.title=t.target.value}),"Address1"===t.getAttribute("name").substr(1)&&t.addEventListener("blur",t=>{let r;Array.from(document.querySelectorAll("#addy1 option")).forEach(e=>{e.value===t.target.value&&(r=e.getAttribute("data-value"))}),void 0!==r&&Array.from(document.querySelectorAll("#addy2 option")).forEach(n=>{n.getAttribute("data-value")===r&&(e.getClosest(t.target,"fieldset").querySelector("input[name='"+t.target.getAttribute("name").slice(0,-1)+"2']").value=n.value)})})}),Array.from(t.querySelectorAll("#toMe, #fromMe")).forEach(t=>{t.addEventListener("click",t=>{let r="deliveryField"===e.getClosest(t.target,"fieldset").getAttribute("id")?document.querySelector("#pickupField"):document.querySelector("#deliveryField"),n="";Array.from(r.querySelectorAll(".clientList")).forEach(e=>{n+=e.value});let o=document.querySelector("input[name='ClientName'][form='javascriptVars']").value+document.querySelector("input[name='Department'][form='javascriptVars']").value+document.querySelector("input[name='ShippingAddress1'][form='javascriptVars']").value+document.querySelector("input[name='ShippingAddress2'][form='javascriptVars']").value;n===o&&t.preventDefault()}),t.addEventListener("change",t=>{let r="deliveryField"===e.getClosest(t.target,"fieldset").getAttribute("id")?document.querySelector("#pickupField"):document.querySelector("#deliveryField");t.target.checked?(e.getClosest(t.target,"thead").querySelector(".onFile").checked=!1,e.triggerEvent(e.getClosest(t.target,"thead").querySelector(".onFile"),"change"),Array.from(e.getClosest(t.target,"fieldset").querySelectorAll(".clientList")).forEach(e=>{e.disabled=!1,e.required=!1,e.readOnly=!0,e.style.display="inline"}),Array.from(e.getClosest(t.target,"fieldset").querySelectorAll(".clientSelect")).forEach(e=>{e.disabled=!0,e.style.display="none"}),r.querySelector(".me").disabled=!0,e.getClosest(t.target,"fieldset").querySelector("[id$='Client']").value=document.querySelector("input[name='ClientName'][form='javascriptVars']").value,e.getClosest(t.target,"fieldset").querySelector("[id$='Department']").value=document.querySelector("input[name='Department'][form='javascriptVars']").value,e.getClosest(t.target,"fieldset").querySelector("[id$='Address1']").value=document.querySelector("input[name='ShippingAddress1'][form='javascriptVars']").value,e.getClosest(t.target,"fieldset").querySelector("[id$='Address2']").value=document.querySelector("input[name='ShippingAddress2'][form='javascriptVars']").value):(Array.from(e.getClosest(t.target,"fieldset").querySelectorAll(".clientList")).forEach(e=>{e.readOnly=!1}),r.querySelector(".me").disabled=!1)})}),Array.from(document.querySelectorAll(".onFile")).forEach(t=>{t.addEventListener("change",t=>{t.target.checked?(e.getClosest(t.target,"thead").querySelector(".me").checked=!1,Array.from(e.getClosest(t.target,"fieldset").querySelectorAll(".clientList")).forEach(e=>{e.disabled=!0,e.required=!1,e.readOnly=!1,e.style.display="none"}),Array.from(e.getClosest(t.target,"fieldset").querySelectorAll(".clientSelect")).forEach(e=>{e.disabled=!1,e.style.display="inline"}),"onFileP"===t.target.id?document.querySelector("#toMe").disabled=!1:document.querySelector("#fromMe").disabled=!1):(Array.from(e.getClosest(t.target,"fieldset").querySelectorAll(".clientList")).forEach(e=>{e.disabled=!1,e.required="Department"!==e.getAttribute("name").substr(1),e.style.display="inline"}),Array.from(e.getClosest(t.target,"fieldset").querySelectorAll(".clientSelect")).forEach(e=>{e.disabled=!0,e.style.display="none"}))})}),Array.from(document.querySelectorAll(".clientSelect")).forEach(t=>{t.addEventListener("change",t=>{let r=t.target.options[t.target.selectedIndex].getAttribute("data-value");Array.from(e.getClosest(t.target,"fieldset").querySelectorAll(".clientSelect")).forEach(e=>{Array.from(e.options).forEach(e=>{e.selected=e.getAttribute("data-value")===r})})})}),t.querySelector(".receivedReady").addEventListener("change",r=>{Array.from(t.querySelectorAll(".readyNote, .readyDate")).forEach(t=>{t.style.display="none"===t.style.display?"inline-block":"none",t.classList.contains("readyDate")&&(!0===r.target.checked&&(t.value=""),e.triggerEvent(t,"change"),t.required=!r.target.checked)})}),t.querySelector(".readyDate").addEventListener("change",e=>{if(new Date>=new Date(e.target.value)){let e=document.createElement("p");e.classList.add("readyError"),e.innerHTML='Ready Time should be either "Now" or a time in the future.',t.querySelector(".readyError")||t.querySelector(".ticketError").appendChild(e)}else if(t.querySelector(".readyError")){let e=t.querySelector(".readyError");e.parentNode.removeChild(e)}t.querySelector(".submitForm").disabled=null!==t.querySelector(".readyError")}),t.querySelector(".cancelTicketEditor")&&t.querySelector(".cancelTicketEditor").addEventListener("click",e=>{t.removeChild(t.querySelector(".removableByEditor")),Array.from(t.querySelectorAll("table.hide, hr.hide, button.hide")).forEach(e=>{e.classList.remove("hide")})}),t.querySelector(".submitForm").addEventListener("click",async r=>{r.preventDefault(),r.target.disabled=!0,t.querySelector(".cancelTicketEditor")&&(t.querySelector(".cancelTicketEditor").disabled=!0);let n=1,o=document.createElement("span");t.querySelector(".diWeight")&&(n=t.querySelector(".diWeight").getAttribute("step")),o.classList.add("ellipsis"),o.innerHTML=".",t.querySelector(".ticketError").innerHTML="",t.querySelector(".ticketError").appendChild(o);let a=!0,l=setInterval(()=>{!0===a&&(o.innerHTML+="..",a=o.innerHTML.length<21&&1!=o.innerHTML.length),!1===a&&(o.innerHTML=o.innerHTML.substr(0,o.innerHTML.length-2),a=1===o.innerHTML.length)},500),i=!1,c="deliveryRequest"===t.querySelector(".removableByEditor").getAttribute("id")?"":t.querySelector(".removableByEditor").getAttribute("id").match(/\d+/)[0],s=["pClient","pAddress1","pAddress2","pCountry","dClient","dAddress1","dAddress2","dCountry","dispatchedTo","billTo"],u={};if(""!==c&&"0"!==document.querySelector("#request"+c+" input[name='contract']").value||s.push("requestedBy"),Array.from(t.querySelectorAll("input[form='request"+c+"'], select[form='request"+c+"'], textarea[form='request"+c+"']")).forEach(e=>{if(e.name)if("checkbox"!==e.type&&!1===e.disabled){if(-1!==s.indexOf(e.getAttribute("name"))&&""===e.value?(i=!0,e.classList.add("elementError"),setTimeout(()=>{e.classList.remove("elementError")},3e3)):e.classList.remove("elementError"),"readyDate"===e.getAttribute("name")&&"none"!==e.style.display){if(new Date>=new Date(e.value)){i=!0;let r=document.createElement("p");r.classList.add("readyError"),r.classList.add("center"),r.innerHTML='Ready Time should be either "Now" or a time in the future.',t.querySelector(".readyError")||t.querySelector(".ticketError").parentNode.appendChild(r),e.classList.add("elementError"),setTimeout(()=>{e.classList.remove("elementError"),t.querySelector(".readyError")&&r.parentNode.removeChild(r)},3e3)}}u[e.getAttribute("name")]=e.value}else"checkbox"===e.type&&("repeatClient"===e.getAttribute("name")?u[e.getAttribute("name")]=1-e.checked:u[e.getAttribute("name")]=0+e.checked)}),u.formKey=document.querySelector("#formKey").value,u.mapAvailable=e.getClosest(t,".page").querySelector(".mapContainer")?1:0,1!==u.dryIce||u.diWeight%n==0&&0!=u.diWeight||(t.querySelector(".ticketError").innerHTML=`Dry Ice in increments of ${n} only.`,t.querySelector(".diWeight").classList.add("elementError"),i=!0,setTimeout(()=>{t.querySelector(".ticketError").innerHTML="",t.querySelector(".diWeight").classList.remove("elementError")},3500)),!0===i)return clearInterval(l),t.querySelector(".ticketError").innerHTML="",Array.from(t.querySelectorAll(".submitForm, .cancelTicketEditor")).forEach(e=>{e.disabled=!1}),!1;await e.fetch_template({url:"./enterTicket.php",postData:u}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(r=>{if(clearInterval(l),-1!==r.indexOf("Session Error"))return e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1!==r.indexOf('data-value="error"'))throw t.querySelector(".ticketError").innerHTML=r,Array.from(t.querySelectorAll(".submitForm, .cancelTicketEditor")).forEach(e=>{e.disabled=!1}),new Error(r);{let n=(new DOMParser).parseFromString(r,"text/html"),o=n.querySelector("#deliveryConfirmation")||n.querySelector(".editorConfirmation");if(t.querySelector(".removableByEditor").innerHTML="",t.querySelector(".removableByEditor").appendChild(o),u.mapAvailable){scroll(0,0);let t={};Array.from(document.querySelectorAll("input[form='coordinates']")).forEach(e=>{t[e.getAttribute("name")]=e.value}),t.mapDivID="map",e.updateMap(t)}assignConfirmationListeners(t)}}).catch(e=>{console.error(e.message),clearInterval(l),t.querySelector(".ticketError").innerHTML='<span class="error">Error</span>: '+e.message,setTimeout(()=>{t.querySelector(".ticketError").innerHTML=""},3500),Array.from(t.querySelectorAll(".submitForm, .cancelTicketEditor")).forEach(e=>{e.disabled=!1})})})}),assignConfirmationListeners=(t=>{let r=new DOMParser;Array.from(t.querySelectorAll(".confirmed, .editForm")).forEach(n=>{n.addEventListener("click",async n=>{n.preventDefault();n.target.getAttribute("form");let o={};o.formKey=document.querySelector("#formKey").value,o.ticketEditor=1,Array.from(t.querySelectorAll("input[form='"+n.target.getAttribute("form")+"']")).forEach(e=>{o[e.getAttribute("name")]=e.value}),n.target.classList.contains("confirmed")&&/\d/.test(n.target.getAttribute("form"))&&(o.updateTicket=1),n.target.classList.contains("editForm")&&!/\d/.test(n.target.getAttribute("form"))&&(o.ticketEditor=0),await e.fetch_template({url:"./enterTicket.php",postData:o}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(o=>{if(-1!==o.indexOf("Session Error"))return e.showLogin();if(document.querySelector("#formKey").value=Number(document.querySelector("#formKey").value)+1,-1!==o.indexOf('data-value="error"'))throw new Error(o);if(n.target.classList.contains("editForm")){Array.from(t.querySelectorAll("datalist, .removableByEditor")).forEach(e=>{e.parentNode.removeChild(e)});let a=r.parseFromString(o,"text/html"),l=document.createDocumentFragment(),i=document.querySelector(".subContainer");Array.from(a.querySelectorAll("datalist, div")).forEach(e=>{l.appendChild(e)}),t.appendChild(l),/\d/.test(n.target.getAttribute("form"))||(t.appendChild(i),e.updateMap({mapDivID:"map"})),assignTicketFormListeners(t)}else if(n.target.classList.contains("confirmed")){if("remove"===o){let e=document.createElement("p");return e.classList.add("center"),e.innerHTML="Update Successful",t.appendChild(e),scrollTo(0,document.querySelector("header").offsetHeight+5),void setTimeout(()=>{document.remove(t)},3e3)}if(e.getClosest(t,".page").querySelector(".mapContainer")){let t=r.parseFromString(o,"text/html");document.querySelector("#deliveryConfirmation").innerHTML="",document.querySelector("#deliveryConfirmation").appendChild(t.querySelector("#deliveryRequestComplete")),setTimeout(e.refreshTicketEntry,3500)}else{let t=document.querySelector("#ticketEditorResultContainer"),a=e.getClosest(n.target,".sortable"),l=r.parseFromString(o,"text/html"),i=document.createDocumentFragment(),c=document.createElement("p");c.classList.add("center"),c.innerHTML="Update Successful",a.appendChild(c),i.appendChild(l.querySelector(".sortable")),setTimeout(()=>{t.insertBefore(i,a),t.removeChild(a),assignTicketEditorListener()},3500)}}}).catch(e=>{console.error(e.message),t.querySelector(".ticketError").innerHTML='<p class="ceneter"><span class="error">Error</span>: '+e.message+"</p>",setTimeout(()=>{t.querySelector(".ticketError").innerHTML=""},3500)})})})})}(window.rjdci=window.rjdci||{}),(()=>{document.addEventListener("rjdci_resolutionchange",function(){setTimeout(()=>{rjdci.fixDeadRunButton(),rjdci.centerForm(document.querySelector("#confirmLogin"))},500)}),document.addEventListener("rjdci_loggedout",function(){setTimeout(rjdci.disableApp,500)}),document.addEventListener("rjdci_loggedin",function(){setTimeout(rjdci.enableApp,500)});const e=document.querySelector("header"),t=document.querySelector(".menu__header");function r(){navigator.onLine?(e.classList.remove("app__offline"),t.style.background="#1E88E5"):(rjdci.toast("You are now offline.."),e.classList.add("app__offline"),t.style.background="#9E9E9E")}document.addEventListener("DOMContentLoaded",function(e){navigator.onLine||r(),window.addEventListener("online",r,!1),window.addEventListener("offline",r,!1)});let n=document.querySelector(".header__icon"),o=document.querySelector(".menu"),a=document.querySelector(".menu__overlay"),l=document.querySelector(".fab__push");function i(){o.style.transform="translateX(-110%)",o.classList.remove("menu--show"),a.classList.remove("menu__overlay--show")}n.addEventListener("click",function(){if(null!==document.querySelector("#signature-pad"))return!1;if(document.querySelector("header").classList.contains("loggedout"))return!1;let e=document.querySelector("#newUpdate");null!==e&&(e.classList.contains("hide")||e.classList.add("hide"));o.style.transform="translateX(0)",o.classList.add("menu--show"),a.classList.add("menu__overlay--show")},!1),a.addEventListener("click",i,!1),Array.from(document.querySelectorAll(".menu__list li")).forEach(e=>{e.addEventListener("click",i,!1)}),null!==l&&l.addEventListener("click",i,!1),domready(()=>{rjdci.assignLinkValues(),document.querySelector("#logoutLink button").addEventListener("click",e=>{e.preventDefault(),rjdci.logout()}),document.querySelector("#confirmLogin")&&rjdci.populatePage().then(()=>{rjdci.assignListeners(),rjdci.assignQueriedTicketListeners(),document.dispatchEvent(rjdci.loaded)}),Array.from(document.querySelectorAll(".menu__list li")).forEach(e=>{e.addEventListener("click",()=>{e.querySelector("a")&&rjdciSwipe.slide(e.querySelector("a").getAttribute("data-value"),300)})}),document.querySelector(".header__icon").addEventListener("click",()=>{let e=document.querySelector("#sig"),t=document.querySelector("#confirmLogin");if(null!==e||t.offsetWidth>0&&t.offsetHeight>0)return!1}),document.querySelector(".refresh").addEventListener("click",()=>{location.reload()}),document.querySelector("#confirm").addEventListener("click",async e=>{e.preventDefault();let t=!1;if(Array.from(document.querySelectorAll("#login input")).forEach(e=>{"function"!==e.id&&""===e.value&&(t=!0,e.classList.add("elementError"),setTimeout(()=>{e.classList.remove("elementError")},3e3))}),!0===t)return!1;let r=document.createElement("span");r.classList.add("ellipsis"),r.innerHTML=".",document.querySelector("#confirmMessage").appendChild(r);let n=!0,o=setInterval(()=>{!0===n&&(r.innerHTML+="..",n=r.innerHTML.length<21&&1!=r.innerHTML.length),!1===n&&(r.innerHTML=r.innerHTML.substr(0,r.innerHTML.length-2),n=1===r.innerHTML.length)},500),a={};a.clientID=document.querySelector("#uid").value,a.upw=document.querySelector("#upw").value,a.mobile=document.querySelector("#mobile").value,a.noSession=1,await rjdci.fetch_template({url:"./refreshFormKey.php"}).then(e=>{if(void 0===e)throw new Error("Result Undefined");if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(async e=>(document.querySelector("#formKey").value=e,await rjdci.fetch_template({url:"../login.php",postData:a}))).then(e=>{if(void 0===e)throw new Error(e.status+" "+e.statusText);if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}).then(e=>{if(clearInterval(o),-1!==e.indexOf("Session Error"))throw new Error("Session Error");if(-1!==e.indexOf("error")||-1!==e.indexOf("Invalid Credentials"))throw new Error(e);document.querySelector("#confirmMessage").innerHTML="User Confirmed",setTimeout(()=>{if(document.querySelector("#confirmMessage").innerHTML="",document.querySelector("#confirmLogin").classList.add("hide"),""!==document.querySelector("#function").value){let e=document.querySelector("#function").value;document.querySelector("#function").value="",rjdci[e]()}document.dispatchEvent(rjdci.loggedin)},1e3)}).catch(e=>{clearInterval(o),document.querySelector("#confirmMessage").innerHTML='<span class="error">Error</span>: '+e.message,setTimeout(()=>{document.querySelector("#confirmMessage").innerHTML=""},4e3)})}),document.querySelector("#cancel").addEventListener("click",()=>{window.location.assign("./logout")})})})();
